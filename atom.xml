<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Hexo</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2021-06-30T07:37:14.203Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>dly</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ä¹¦å•</title>
    <link href="http://example.com/2021/06/30/%E4%B9%A6%E5%8D%95/"/>
    <id>http://example.com/2021/06/30/%E4%B9%A6%E5%8D%95/</id>
    <published>2021-06-30T07:20:42.000Z</published>
    <updated>2021-06-30T07:37:14.203Z</updated>
    
    <content type="html"><![CDATA[<p>å¤©ä¸‹ç†™ç†™çš†ä¸ºåˆ©æ¥ï¼Œå¤©ä¸‹æ”˜æ”˜çš†ä¸ºåˆ©å¾€ã€‚</p><p>ä¹¦ç±æ˜¯äººç±»è¿›æ­¥çš„é˜¶æ¢¯ã€‚</p><p>ä¸ºäº†æ˜å¤©ï¼Œå¹²æ¯ğŸ»</p><p>æˆ‘ä¹Ÿè¦å†™å‡ºå¼ºæ‚çš„ä»£ç ï¼</p><h4 id="æˆ‘çš„ä¹¦å•"><a href="#æˆ‘çš„ä¹¦å•" class="headerlink" title="æˆ‘çš„ä¹¦å•"></a>æˆ‘çš„ä¹¦å•</h4><h5 id="æŠ€æœ¯åºåˆ—"><a href="#æŠ€æœ¯åºåˆ—" class="headerlink" title="æŠ€æœ¯åºåˆ—"></a>æŠ€æœ¯åºåˆ—</h5><h6 id="Java-8å®æˆ˜"><a href="#Java-8å®æˆ˜" class="headerlink" title="Java 8å®æˆ˜"></a>Java 8å®æˆ˜</h6><blockquote><p>å¯¹java8ä¸­çš„æ–°ç‰¹æ€§ä»‹ç»çš„éå¸¸å…¨é¢ï¼Œå°¤å…¶æ˜¯lamdbaè¡¨è¾¾å¼å’Œæµçš„æ“ä½œã€‚å¦å¤–å…³äºæ—¥æœŸçš„APIï¼Œå¼‚æ­¥ç¼–ç¨‹ï¼ŒOptionalï¼Œå‡½æ•°å¼ç¼–ç¨‹ç­‰ä¹Ÿå¯¹æ—¥å¸¸å¼€å‘ä¸­æœ‰å¾ˆå¼ºçš„å€Ÿé‰´ä½œç”¨ã€‚</p></blockquote><h6 id="Javaæ€§èƒ½æƒå¨æŒ‡å—-Java-Performance-The-Definitive-Guide"><a href="#Javaæ€§èƒ½æƒå¨æŒ‡å—-Java-Performance-The-Definitive-Guide" class="headerlink" title="Javaæ€§èƒ½æƒå¨æŒ‡å—|Java Performance: The Definitive Guide"></a>Javaæ€§èƒ½æƒå¨æŒ‡å—|Java Performance: The Definitive Guide</h6><h6 id="å®æˆ˜Javaé«˜å¹¶å‘ç¨‹åºè®¾è®¡-è‘›ä¸€é¸£"><a href="#å®æˆ˜Javaé«˜å¹¶å‘ç¨‹åºè®¾è®¡-è‘›ä¸€é¸£" class="headerlink" title="å®æˆ˜Javaé«˜å¹¶å‘ç¨‹åºè®¾è®¡|è‘›ä¸€é¸£"></a>å®æˆ˜Javaé«˜å¹¶å‘ç¨‹åºè®¾è®¡|è‘›ä¸€é¸£</h6><h6 id="avaå¹¶å‘ç¼–ç¨‹å®æˆ˜"><a href="#avaå¹¶å‘ç¼–ç¨‹å®æˆ˜" class="headerlink" title="avaå¹¶å‘ç¼–ç¨‹å®æˆ˜"></a>avaå¹¶å‘ç¼–ç¨‹å®æˆ˜</h6><h6 id="Effective-Javaä¸­æ–‡ç‰ˆï¼ˆç¬¬3ç‰ˆï¼‰-Effective-Java-Third-Edition"><a href="#Effective-Javaä¸­æ–‡ç‰ˆï¼ˆç¬¬3ç‰ˆï¼‰-Effective-Java-Third-Edition" class="headerlink" title="Effective Javaä¸­æ–‡ç‰ˆï¼ˆç¬¬3ç‰ˆï¼‰|Effective Java Third Edition"></a>Effective Javaä¸­æ–‡ç‰ˆï¼ˆç¬¬3ç‰ˆï¼‰|Effective Java Third Edition</h6><h6 id="æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºï¼ˆç¬¬3ç‰ˆï¼‰-å‘¨å¿—æ˜"><a href="#æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºï¼ˆç¬¬3ç‰ˆï¼‰-å‘¨å¿—æ˜" class="headerlink" title="æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºï¼ˆç¬¬3ç‰ˆï¼‰| å‘¨å¿—æ˜"></a>æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºï¼ˆç¬¬3ç‰ˆï¼‰| å‘¨å¿—æ˜</h6><h6 id="Javaè™šæ‹Ÿæœºè§„èŒƒï¼ˆJava-SE-8ç‰ˆï¼‰-çˆ±é£ç¿”ã€å‘¨å¿—æ˜"><a href="#Javaè™šæ‹Ÿæœºè§„èŒƒï¼ˆJava-SE-8ç‰ˆï¼‰-çˆ±é£ç¿”ã€å‘¨å¿—æ˜" class="headerlink" title="Javaè™šæ‹Ÿæœºè§„èŒƒï¼ˆJava SE 8ç‰ˆï¼‰|çˆ±é£ç¿”ã€å‘¨å¿—æ˜"></a>Javaè™šæ‹Ÿæœºè§„èŒƒï¼ˆJava SE 8ç‰ˆï¼‰|çˆ±é£ç¿”ã€å‘¨å¿—æ˜</h6><h6 id="MySQLå¿…çŸ¥å¿…ä¼š"><a href="#MySQLå¿…çŸ¥å¿…ä¼š" class="headerlink" title="MySQLå¿…çŸ¥å¿…ä¼š"></a>MySQLå¿…çŸ¥å¿…ä¼š</h6><h6 id="é«˜æ€§èƒ½MySQL"><a href="#é«˜æ€§èƒ½MySQL" class="headerlink" title="é«˜æ€§èƒ½MySQL"></a>é«˜æ€§èƒ½MySQL</h6><h6 id="Redisè®¾è®¡ä¸å®ç°-é»„å¥å®"><a href="#Redisè®¾è®¡ä¸å®ç°-é»„å¥å®" class="headerlink" title="Redisè®¾è®¡ä¸å®ç°|é»„å¥å®"></a>Redisè®¾è®¡ä¸å®ç°|é»„å¥å®</h6><h6 id="Redis-æ·±åº¦å†é™©ï¼šæ ¸å¿ƒåŸç†ä¸åº”ç”¨å®è·µ-é’±æ–‡å“"><a href="#Redis-æ·±åº¦å†é™©ï¼šæ ¸å¿ƒåŸç†ä¸åº”ç”¨å®è·µ-é’±æ–‡å“" class="headerlink" title="Redis æ·±åº¦å†é™©ï¼šæ ¸å¿ƒåŸç†ä¸åº”ç”¨å®è·µ|é’±æ–‡å“"></a>Redis æ·±åº¦å†é™©ï¼šæ ¸å¿ƒåŸç†ä¸åº”ç”¨å®è·µ|é’±æ–‡å“</h6><h6 id="TCP-IPè¯¦è§£-å·1ï¼šåè®®"><a href="#TCP-IPè¯¦è§£-å·1ï¼šåè®®" class="headerlink" title="TCP/IPè¯¦è§£ å·1ï¼šåè®®"></a>TCP/IPè¯¦è§£ å·1ï¼šåè®®</h6><h6 id="æ·±å…¥å‰–æTomcat"><a href="#æ·±å…¥å‰–æTomcat" class="headerlink" title="æ·±å…¥å‰–æTomcat"></a>æ·±å…¥å‰–æTomcat</h6><h6 id="æ¶æ„æ¢é™©åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶-æä¸šå…µ"><a href="#æ¶æ„æ¢é™©åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶-æä¸šå…µ" class="headerlink" title="æ¶æ„æ¢é™©åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶ | æä¸šå…µ"></a>æ¶æ„æ¢é™©åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶ | æä¸šå…µ</h6><h6 id="æ·±å…¥åˆ†æJavaWebæŠ€æœ¯å†…å¹•-è®¸ä»¤æ³¢"><a href="#æ·±å…¥åˆ†æJavaWebæŠ€æœ¯å†…å¹•-è®¸ä»¤æ³¢" class="headerlink" title="æ·±å…¥åˆ†æJavaWebæŠ€æœ¯å†…å¹• | è®¸ä»¤æ³¢"></a>æ·±å…¥åˆ†æJavaWebæŠ€æœ¯å†…å¹• | è®¸ä»¤æ³¢</h6><blockquote><p>javaç¼–è¯‘åŸç†ã€ Servletå·¥ä½œåŸç†ã€ Tomcatã€springå’ŒiBatisè¿™å‡ ç« çš„æ”¶è·å¾ˆå¤§ã€‚</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å¤©ä¸‹ç†™ç†™çš†ä¸ºåˆ©æ¥ï¼Œå¤©ä¸‹æ”˜æ”˜çš†ä¸ºåˆ©å¾€ã€‚&lt;/p&gt;
&lt;p&gt;ä¹¦ç±æ˜¯äººç±»è¿›æ­¥çš„é˜¶æ¢¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æ˜å¤©ï¼Œå¹²æ¯ğŸ»&lt;/p&gt;
&lt;p&gt;æˆ‘ä¹Ÿè¦å†™å‡ºå¼ºæ‚çš„ä»£ç ï¼&lt;/p&gt;
&lt;h4 id=&quot;æˆ‘çš„ä¹¦å•&quot;&gt;&lt;a href=&quot;#æˆ‘çš„ä¹¦å•&quot; class=&quot;headerlink&quot; title=&quot;æˆ‘çš„ä¹¦</summary>
      
    
    
    
    <category term="éšç¬”" scheme="http://example.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
  </entry>
  
  <entry>
    <title>sqlUtil</title>
    <link href="http://example.com/2021/06/29/sqlUtil/"/>
    <id>http://example.com/2021/06/29/sqlUtil/</id>
    <published>2021-06-29T07:30:05.000Z</published>
    <updated>2021-06-29T07:33:55.803Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SqlUtil</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * å°†å®ä½“ç±»çš„listè½¬ä¸ºæ‰¹é‡æ’å…¥çš„sql</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">convertDOListToInsertSql</span><span class="params">(List&lt;T&gt; doList, Class&lt;T&gt; tclass)</span> <span class="keyword">throws</span> IllegalAccessException </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (doList == <span class="keyword">null</span> || doList.size() == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        StringBuilder sql = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">         <span class="comment">// é€šè¿‡åå°„å›å»å®ä½“ç±»å¯¹åº”çš„è¡¨åå’Œå­—æ®µå</span></span><br><span class="line">        Table tableAnnotation = tclass.getAnnotation(Table.class);</span><br><span class="line">         <span class="comment">// å¦‚æœæ²¡æœ‰tableæ³¨è§£ï¼ŒæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">        <span class="keyword">if</span> (tableAnnotation == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(tclass.getSimpleName() + <span class="string">&quot;æ²¡æœ‰å¯¹åº”çš„æ•°æ®åº“è¡¨&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        String tableName = tableAnnotation.name();</span><br><span class="line">        Field[] fields = tclass.getDeclaredFields();</span><br><span class="line"></span><br><span class="line">         <span class="comment">// è·å–æ•°æ®åº“åˆ—åå’Œå®ä½“ç±»å­—æ®µåå¯¹åº”å…³ç³»</span></span><br><span class="line">        List&lt;String&gt; columnNameList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">            field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">            String columnName = getColumnNameByField(field);</span><br><span class="line">            columnNameList.add(columnName);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">         <span class="comment">// æ‹¼æ¥sql</span></span><br><span class="line">        sql.append(<span class="string">&quot;INSERT INTO &quot;</span>).append(tableName).append(<span class="string">&quot; (&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; columnNameList.size(); i++) &#123;</span><br><span class="line">            sql.append(columnNameList.get(i));</span><br><span class="line">            <span class="keyword">if</span> (i &lt; (columnNameList.size() - <span class="number">1</span>))&#123;</span><br><span class="line">                sql.append(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        sql.append(<span class="string">&quot;) VALUES &quot;</span>);</span><br><span class="line">         <span class="comment">// æ‹¼æ¥å­—æ®µå€¼ï¼ŒStringéœ€è¦åŠ å•å¼•å·ï¼Œå¸ƒå°”éœ€è¦è½¬æ¢æˆ1å’Œ0ï¼Œæ•°å­—ç±»å‹ä¿æŒä¸å˜ï¼Œå…¶ä»–ç±»å‹æš‚ä¸æ”¯æŒ</span></span><br><span class="line">         <span class="comment">// <span class="doctag">TODO:</span> æ—¥æœŸç±»å‹å’‹åŠï¼Ÿæšä¸¾ç±»å‹å’‹åŠï¼Ÿ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; doList.size(); i++) &#123;</span><br><span class="line">            T entity = doList.get(i);</span><br><span class="line">            sql.append(<span class="string">&quot;(&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; fields.length; j++) &#123;</span><br><span class="line">                Field field = fields[j];</span><br><span class="line">                <span class="keyword">if</span> (field.get(entity) == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    sql.append(<span class="string">&quot;NULL&quot;</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (field.getType().getName().equals(<span class="string">&quot;java.lang.String&quot;</span>)) &#123;</span><br><span class="line">                        <span class="comment">// å¦‚æœè¾“å…¥å­—ç¬¦ä¸²ä¸­ä»¥&#x27;æ‰“æ–­ï¼Œå³å¯è‡ªè¡Œè¾“å…¥åç»­sqlå†…å®¹ï¼Œå­˜åœ¨sqlæ³¨å…¥é£é™©ï¼Œä¸´æ—¶ä¿®æ”¹æ–¹æ¡ˆ</span></span><br><span class="line">                        String sfield = (String) field.get(entity);</span><br><span class="line">                        sql.append(<span class="string">&quot;&#x27;&quot;</span>).append(sfield.replace(<span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;&quot;</span>)).append(<span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (field.getType().getName().equals(<span class="string">&quot;java.lang.Boolean&quot;</span>)) &#123;</span><br><span class="line">                        sql.append((Boolean) field.get(entity) ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (field.getType().getName().equals(<span class="string">&quot;java.util.Date&quot;</span>)) &#123;</span><br><span class="line">                        SimpleDateFormat simpleDateFormat = <span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>);</span><br><span class="line">                        String dateString = simpleDateFormat.format((Date) field.get(entity));</span><br><span class="line">                        sql.append(<span class="string">&quot;&#x27;&quot;</span>).append(dateString).append(<span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        sql.append(<span class="string">&quot;&#x27;&quot;</span>).append(field.get(entity)).append(<span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (j &lt; (fields.length - <span class="number">1</span>))&#123;</span><br><span class="line">                    sql.append(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            sql.append(<span class="string">&quot;)&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (i &lt; (doList.size() - <span class="number">1</span>))&#123;</span><br><span class="line">                sql.append(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sql.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">     <span class="comment">// æ ¹æ®å®ä½“ç±»ä¸­çš„fieldï¼Œè·å–å¯¹åº”åœ¨æ•°æ®åº“ä¸­çš„å­—æ®µå</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">getColumnNameByField</span><span class="params">(Field field)</span> </span>&#123;</span><br><span class="line">        Column columnAnnotation = field.getAnnotation(Column.class);</span><br><span class="line">        <span class="keyword">if</span> (columnAnnotation == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">         <span class="comment">// å¦‚æœcolumnæ³¨è§£æœ‰nameå±æ€§çš„è¯ï¼Œnameå±æ€§å°±æ˜¯åˆ—åï¼Œå¦‚æœæ²¡æœ‰nameå±æ€§ï¼Œå°±æ˜¯å­—æ®µåé©¼å³°è½¬ä¸‹æ»‘è´¤</span></span><br><span class="line">        String columnName = columnAnnotation.name();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;&quot;</span>.equals(columnName)) &#123;</span><br><span class="line">            String fieldName = field.getName();</span><br><span class="line">            columnName = CaseFormat.UPPER_CAMEL.to(CaseFormat.LOWER_UNDERSCORE, fieldName);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> columnName;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=</summary>
      
    
    
    
    <category term="éšç¬”" scheme="http://example.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
  </entry>
  
  <entry>
    <title>HttpClient</title>
    <link href="http://example.com/2021/06/15/HttpClient/"/>
    <id>http://example.com/2021/06/15/HttpClient/</id>
    <published>2021-06-15T03:19:25.000Z</published>
    <updated>2021-06-15T03:21:38.854Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpClient</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAX_TIMEOUT = <span class="number">30000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String CHARSET_UTF8 = <span class="string">&quot;UTF-8&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SSLContext sslContext;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Registry&lt;ConnectionSocketFactory&gt; socketFactoryRegistry;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> PoolingHttpClientConnectionManager connectionManager;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> RequestConfig requestConfig = RequestConfig.custom()</span><br><span class="line">            <span class="comment">// è®¾ç½®è¿æ¥è¶…æ—¶</span></span><br><span class="line">            .setConnectTimeout(MAX_TIMEOUT)</span><br><span class="line">            <span class="comment">// è®¾ç½®è¯»å–è¶…æ—¶</span></span><br><span class="line">            .setSocketTimeout(MAX_TIMEOUT)</span><br><span class="line">            <span class="comment">// è®¾ç½®ä»è¿æ¥æ± è·å–è¿æ¥å®ä¾‹çš„è¶…æ—¶</span></span><br><span class="line">            .setConnectionRequestTimeout(MAX_TIMEOUT)</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            sslContext = SSLContext.getInstance(<span class="string">&quot;SSL&quot;</span>);</span><br><span class="line">            sslContext.init(<span class="keyword">null</span>,</span><br><span class="line">                    <span class="keyword">new</span> TrustManager[]&#123;<span class="keyword">new</span> HttpClient.TrustAnyTrustManager()&#125;,</span><br><span class="line">                    <span class="keyword">new</span> SecureRandom());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (KeyManagementException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½®åè®®httpå’Œhttpså¯¹åº”çš„å¤„ç†socketé“¾æ¥å·¥å‚çš„å¯¹è±¡</span></span><br><span class="line">        socketFactoryRegistry = RegistryBuilder.&lt;ConnectionSocketFactory&gt;create()</span><br><span class="line">                .register(<span class="string">&quot;http&quot;</span>, PlainConnectionSocketFactory.INSTANCE)</span><br><span class="line">                .register(<span class="string">&quot;https&quot;</span>, <span class="keyword">new</span> SSLConnectionSocketFactory(sslContext))</span><br><span class="line">                .build();</span><br><span class="line"></span><br><span class="line">        connectionManager = <span class="keyword">new</span> PoolingHttpClientConnectionManager(socketFactoryRegistry);</span><br><span class="line">        connectionManager.setDefaultSocketConfig(SocketConfig.custom().setTcpNoDelay(<span class="keyword">true</span>).build());</span><br><span class="line">        connectionManager.setMaxTotal(<span class="number">300</span>); <span class="comment">// å…¨å¹¶å‘</span></span><br><span class="line">        connectionManager.setDefaultMaxPerRoute(<span class="number">300</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> CloseableHttpClient httpClient = HttpClients.custom()</span><br><span class="line">            .setConnectionManager(connectionManager)</span><br><span class="line">            .setDefaultRequestConfig(requestConfig)</span><br><span class="line">            .setRetryHandler(<span class="keyword">new</span> StandardHttpRequestRetryHandler())</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;Q, T&gt; <span class="function">T <span class="title">doPost</span><span class="params">(RequestInterface reqInterface, Map&lt;String, String&gt; headers, Q requestObject, Class&lt;T&gt; responseClass)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Map&lt;String, String&gt; params = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        String json = JsonUtils.object2Json(requestObject);</span><br><span class="line">        log.info(<span class="string">&quot;requestContent:&#123;&#125;&quot;</span>, json);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            params = JsonUtils.readValue(json, <span class="keyword">new</span> TypeReference&lt;Map&lt;String, String&gt;&gt;() &#123;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;json read value error&quot;</span>);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> doPost(reqInterface, headers, params, responseClass);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">T <span class="title">doPost</span><span class="params">(RequestInterface reqInterface, Map&lt;String, String&gt; headers, Map&lt;String, String&gt; params, Class&lt;T&gt; responseClass)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        T result = <span class="keyword">null</span>;</span><br><span class="line">        CloseableHttpResponse response = <span class="keyword">null</span>;</span><br><span class="line">        HttpPost httpPost = <span class="keyword">new</span> HttpPost(reqInterface.getUrl());</span><br><span class="line">        <span class="keyword">if</span> (headers != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry : headers.entrySet()) &#123;</span><br><span class="line">                httpPost.addHeader(entry.getKey(), entry.getValue());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">switch</span> (reqInterface.getRequestType()) &#123;</span><br><span class="line">            <span class="keyword">case</span> FORM:</span><br><span class="line">                List&lt;NameValuePair&gt; pairList = <span class="keyword">new</span> ArrayList&lt;&gt;(params.size());</span><br><span class="line">                params.forEach((key, value) -&gt; &#123;</span><br><span class="line">                    NameValuePair pair = <span class="keyword">new</span> BasicNameValuePair(key, value);</span><br><span class="line">                    pairList.add(pair);</span><br><span class="line">                &#125;);</span><br><span class="line">                httpPost.setEntity(<span class="keyword">new</span> UrlEncodedFormEntity(pairList, Charsets.UTF_8));</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> JSON:</span><br><span class="line">                httpPost.addHeader(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json;charset=utf-8&quot;</span>);</span><br><span class="line">                httpPost.setEntity(<span class="keyword">new</span> StringEntity(JsonUtils.object2Json(params), Charsets.UTF_8));</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            response = httpClient.execute(httpPost);</span><br><span class="line">            String respContent = EntityUtils.toString(response.getEntity(), CHARSET_UTF8);</span><br><span class="line">            log.info(<span class="string">&quot;respContent=&#123;&#125;&quot;</span>, respContent);</span><br><span class="line">            <span class="keyword">if</span> (responseClass != <span class="keyword">null</span>) &#123;</span><br><span class="line">                result = JsonUtils.readValue(respContent, responseClass);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;httpClient execute error&quot;</span>);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (response != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    EntityUtils.consume(response.getEntity());</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    log.error(<span class="string">&quot;response connection release error&quot;</span>);</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">T <span class="title">doPost</span><span class="params">(String path, Map&lt;String, String&gt; headers, String entity, Class&lt;T&gt; responseClass)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        T result = <span class="keyword">null</span>;</span><br><span class="line">        CloseableHttpResponse response = <span class="keyword">null</span>;</span><br><span class="line">        HttpPost httpPost = <span class="keyword">new</span> HttpPost(path);</span><br><span class="line">        <span class="keyword">if</span> (headers != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry : headers.entrySet()) &#123;</span><br><span class="line">                httpPost.addHeader(entry.getKey(), entry.getValue());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        httpPost.setEntity(<span class="keyword">new</span> StringEntity(entity, Charsets.UTF_8));</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            response = httpClient.execute(httpPost);</span><br><span class="line">            String respContent = EntityUtils.toString(response.getEntity(), CHARSET_UTF8);</span><br><span class="line">            log.info(<span class="string">&quot;respContent=&#123;&#125;&quot;</span>, respContent);</span><br><span class="line">            result = JsonUtils.readValue(respContent, responseClass);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;httpClient execute error&quot;</span>);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (response != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    EntityUtils.consume(response.getEntity());</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    log.error(<span class="string">&quot;response connection release error&quot;</span>);</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// put æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;Q, T&gt; <span class="function">T <span class="title">doPut</span><span class="params">(String path, Map&lt;String, String&gt; headers, Q requestObject, Class&lt;T&gt; responseClass)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Map&lt;String, Object&gt; params = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        String json = JsonUtils.object2Json(requestObject);</span><br><span class="line">        log.info(<span class="string">&quot;requestContent:&#123;&#125;&quot;</span>, json);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            params = JsonUtils.readValue(json, <span class="keyword">new</span> TypeReference&lt;Map&lt;String, Object&gt;&gt;() &#123;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;json read value error&quot;</span>);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> doPut(path, headers, params, responseClass);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">T <span class="title">doPut</span><span class="params">(String path, Map&lt;String, String&gt; headers, Map&lt;String, Object&gt; params, Class&lt;T&gt; responseClass)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        T result = <span class="keyword">null</span>;</span><br><span class="line">        CloseableHttpResponse response = <span class="keyword">null</span>;</span><br><span class="line">        HttpPut httpPut = <span class="keyword">new</span> HttpPut(path);</span><br><span class="line">        <span class="keyword">if</span> (headers != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry : headers.entrySet()) &#123;</span><br><span class="line">                httpPut.addHeader(entry.getKey(), entry.getValue());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        httpPut.addHeader(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json;charset=utf-8&quot;</span>);</span><br><span class="line">        httpPut.setEntity(<span class="keyword">new</span> StringEntity(JsonUtils.object2Json(params), Charsets.UTF_8));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            response = httpClient.execute(httpPut);</span><br><span class="line">            String respContent = EntityUtils.toString(response.getEntity(), CHARSET_UTF8);</span><br><span class="line">            log.info(<span class="string">&quot;respContent=&#123;&#125;&quot;</span>, respContent);</span><br><span class="line">            respContent = <span class="string">&quot;&#123;\&quot;policies\&quot;:&quot;</span> + respContent + <span class="string">&quot;&#125;&quot;</span>;</span><br><span class="line">            result = JsonUtils.readValue(respContent, responseClass);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;httpClient execute error&quot;</span>);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (response != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    EntityUtils.consume(response.getEntity());</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    log.error(<span class="string">&quot;response connection release error&quot;</span>);</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">T <span class="title">doGet</span><span class="params">(String uri, Map&lt;String, String&gt; headers, TypeReference&lt;T&gt; type)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        T result = <span class="keyword">null</span>;</span><br><span class="line">        CloseableHttpResponse response = <span class="keyword">null</span>;</span><br><span class="line">        HttpGet httpGet = <span class="keyword">new</span> HttpGet(uri);</span><br><span class="line">        <span class="keyword">if</span> (headers != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry : headers.entrySet()) &#123;</span><br><span class="line">                httpGet.addHeader(entry.getKey(), entry.getValue());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            response = httpClient.execute(httpGet);</span><br><span class="line">            String respContent = EntityUtils.toString(response.getEntity(), CHARSET_UTF8);</span><br><span class="line">            log.info(<span class="string">&quot;respContent=&#123;&#125;&quot;</span>, respContent);</span><br><span class="line">            <span class="keyword">if</span> (type != <span class="keyword">null</span>) &#123;</span><br><span class="line">                result = JsonUtils.readValue(respContent, type);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;httpClient execute error&quot;</span>);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (response != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    EntityUtils.consume(response.getEntity());</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    log.error(<span class="string">&quot;response connection release error&quot;</span>);</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;Q, T&gt; <span class="function">T <span class="title">doDelete</span><span class="params">(String uri, Map&lt;String, String&gt; headers, Q requestObject, Class&lt;T&gt; responseClass)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        T result = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        Map&lt;String, String&gt; params = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        String json = JsonUtils.object2Json(requestObject);</span><br><span class="line">        log.info(<span class="string">&quot;requestContent:&#123;&#125;&quot;</span>, json);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            params = JsonUtils.readValue(json, <span class="keyword">new</span> TypeReference&lt;Map&lt;String, String&gt;&gt;() &#123;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;json read value error&quot;</span>);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> doDelete(uri, headers, params, responseClass);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">T <span class="title">doDelete</span><span class="params">(String uri,</span></span></span><br><span class="line"><span class="function"><span class="params">                                 Map&lt;String, String&gt; headers,</span></span></span><br><span class="line"><span class="function"><span class="params">                                 Map&lt;String, String&gt; params,</span></span></span><br><span class="line"><span class="function"><span class="params">                                 Class&lt;T&gt; responseClass)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        T result = <span class="keyword">null</span>;</span><br><span class="line">        CloseableHttpResponse response = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        HttpDeleteWithBody httpDelete = <span class="keyword">new</span> HttpDeleteWithBody(uri);</span><br><span class="line">        <span class="keyword">if</span> (headers != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry : headers.entrySet()) &#123;</span><br><span class="line">                httpDelete.addHeader(entry.getKey(), entry.getValue());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        httpDelete.setEntity(<span class="keyword">new</span> StringEntity(JsonUtils.object2Json(params), Charsets.UTF_8));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            response = httpClient.execute(httpDelete);</span><br><span class="line">            String respContent = EntityUtils.toString(response.getEntity(), CHARSET_UTF8);</span><br><span class="line">            log.info(<span class="string">&quot;respContent=&#123;&#125;&quot;</span>, respContent);</span><br><span class="line">            result = JsonUtils.readValue(respContent, responseClass);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;httpClient execute error&quot;</span>);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (response != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    EntityUtils.consume(response.getEntity());</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    log.error(<span class="string">&quot;response connection release error&quot;</span>);</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TrustAnyTrustManager</span> <span class="keyword">implements</span> <span class="title">X509TrustManager</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="title">TrustAnyTrustManager</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkClientTrusted</span><span class="params">(X509Certificate[] chain, String authType)</span> </span>&#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkServerTrusted</span><span class="params">(X509Certificate[] chain, String authType)</span> </span>&#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> X509Certificate[] getAcceptedIssuers() &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> X509Certificate[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=</summary>
      
    
    
    
    <category term="éšç¬”" scheme="http://example.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
  </entry>
  
  <entry>
    <title>volatile</title>
    <link href="http://example.com/2021/06/09/volatile/"/>
    <id>http://example.com/2021/06/09/volatile/</id>
    <published>2021-06-09T08:55:01.000Z</published>
    <updated>2021-06-09T10:44:15.054Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨è®²è§£volatileä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹å†…å­˜å¯è§æ€§é—®é¢˜</p><p>volatileæ˜¯javaä¸­æ¯”è¾ƒé‡è¦çš„ä¸€ä¸ªå…³é”®å­—ï¼Œå®ƒæ˜¯è½»é‡çº§é”ï¼Œæœ‰ä¸¤ä¸ªä½œç”¨</p><blockquote><ol><li>ä¿è¯å…±äº«å˜é‡åœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´å¯è§</li><li>ç¦æ­¢æŒ‡ä»¤é‡æ’åº</li></ol></blockquote><h4 id="å†…å­˜å¯è§æ€§é—®é¢˜"><a href="#å†…å­˜å¯è§æ€§é—®é¢˜" class="headerlink" title="å†…å­˜å¯è§æ€§é—®é¢˜"></a>å†…å­˜å¯è§æ€§é—®é¢˜</h4><p>é¦–å…ˆæ¥çœ‹çœ‹åœ¨å¤šçº¿ç¨‹ä¸‹å¤„ç†å…±äº«å˜é‡çš„javaå†…å­˜æ¨¡å‹ï¼š</p><p><img src="/2021/06/09/volatile/javaMM.jpg" alt="javaMM"></p><blockquote><p>Javaå†…å­˜æ¨¡å‹è§„å®šï¼Œå°†æ‰€æœ‰çš„å˜é‡éƒ½å­˜æ”¾åœ¨ä¸»å†…å­˜ä¸­ï¼Œå½“çº¿ç¨‹ä½¿ç”¨å˜é‡æ—¶ï¼Œä¼šæŠŠä¸»å†…å­˜é‡Œé¢çš„å˜é‡å¤åˆ¶åˆ°è‡ªå·±çš„å·¥ä½œç©ºé—´æˆ–è€…å«ä½œå·¥ä½œå†…å­˜ï¼Œçº¿ç¨‹è¯»å†™å˜é‡æ—¶æ“ä½œçš„æ˜¯è‡ªå·±å·¥ä½œå†…å­˜ä¸­çš„å˜é‡ã€‚</p></blockquote><p>Javaå†…å­˜æ¨¡å‹æ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µï¼Œé‚£ä¹ˆåœ¨å®é™…å®ç°ä¸­çº¿ç¨‹çš„å·¥ä½œå†…å­˜æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿçœ‹ä¸‹å›¾ï¼š</p><p><img src="/2021/06/09/volatile/javaMMF.png" alt="javaMMF"></p><p>å›¾ä¸­æ‰€ç¤ºæ˜¯ä¸€ä¸ªåŒæ ¸CPUç³»ç»Ÿæ¶æ„ï¼Œæ¯ä¸ªæ ¸æœ‰è‡ªå·±çš„æ§åˆ¶å™¨å’Œè¿ç®—å™¨ï¼Œå…¶ä¸­æ§åˆ¶å™¨åŒ…å«ä¸€ç»„å¯„å­˜å™¨å’Œæ“ä½œæ§åˆ¶å™¨ï¼Œè¿ç®—å™¨æ‰§è¡Œç®—æœ¯é€»è¾‘è¿ç®—ã€‚æ¯ä¸ªæ ¸éƒ½æœ‰è‡ªå·±çš„ä¸€çº§ç¼“å­˜ï¼Œåœ¨æœ‰äº›æ¶æ„é‡Œé¢è¿˜æœ‰ä¸€ä¸ªæ‰€æœ‰CPUéƒ½å…±äº«çš„äºŒçº§ç¼“å­˜ã€‚</p><p>é‚£ä¹ˆ<strong>Javaå†…å­˜æ¨¡å‹é‡Œé¢çš„å·¥ä½œå†…å­˜ï¼Œå°±å¯¹åº”è¿™é‡Œçš„L1æˆ–è€…L2ç¼“å­˜æˆ–è€…CPUçš„å¯„å­˜å™¨</strong>ã€‚</p><p>å½“ä¸€ä¸ªçº¿ç¨‹æ“ä½œå…±äº«å˜é‡æ—¶ï¼Œå®ƒé¦–å…ˆä»ä¸»å†…å­˜å¤åˆ¶å…±äº«å˜é‡åˆ°è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼Œç„¶åå¯¹å·¥ä½œå†…å­˜é‡Œçš„å˜é‡è¿›è¡Œå¤„ç†ï¼Œå¤„ç†å®Œåå°†å˜é‡å€¼æ›´æ–°åˆ°ä¸»å†…å­˜ã€‚</p><p>é‚£ä¹ˆå‡å¦‚çº¿ç¨‹Aå’Œçº¿ç¨‹BåŒæ—¶å¤„ç†ä¸€ä¸ªå…±äº«å˜é‡ï¼Œä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µï¼Ÿæˆ‘ä»¬ä½¿ç”¨å›¾2æ‰€ç¤ºCPUæ¶æ„ï¼Œå‡è®¾çº¿ç¨‹Aå’Œçº¿ç¨‹Bä½¿ç”¨ä¸åŒCPUæ‰§è¡Œï¼Œå¹¶ä¸”å½“å‰ä¸¤çº§Cacheéƒ½ä¸ºç©ºï¼Œé‚£ä¹ˆè¿™æ—¶å€™ç”±äºCacheçš„å­˜åœ¨ï¼Œå°†ä¼šå¯¼è‡´å†…å­˜ä¸å¯è§é—®é¢˜ï¼Œå…·ä½“çœ‹ä¸‹é¢çš„åˆ†æï¼š</p><ul><li>çº¿ç¨‹Aé¦–å…ˆè·å–å…±äº«å˜é‡1çš„å€¼ï¼Œç”±äºä¸¤çº§Cacheéƒ½æ²¡æœ‰å‘½ä¸­ï¼Œæ‰€ä»¥åŠ è½½ä¸»å†…å­˜ä¸­1çš„å€¼ï¼Œå‡å¦‚ä¸º0ã€‚ç„¶åæŠŠvar1=0çš„å€¼ç¼“å­˜åˆ°ä¸¤çº§ç¼“å­˜ï¼Œçº¿ç¨‹Aä¿®æ”¹var1çš„å€¼ä¸º1ï¼Œç„¶åå°†å…¶å†™å…¥ä¸¤çº§Cacheï¼Œå¹¶ä¸”åˆ·æ–°åˆ°ä¸»å†…å­˜ã€‚çº¿ç¨‹Aæ“ä½œå®Œæ¯•åï¼Œçº¿ç¨‹Aæ‰€åœ¨çš„CPUçš„ä¸¤çº§Cacheå†…å’Œä¸»å†…å­˜é‡Œé¢çš„var1çš„å€¼éƒ½æ˜¯1ã€‚</li><li>çº¿ç¨‹Bè·å–var1çš„å€¼ï¼Œé¦–å…ˆä¸€çº§ç¼“å­˜æ²¡æœ‰å‘½ä¸­ï¼Œç„¶åçœ‹äºŒçº§ç¼“å­˜ï¼ŒäºŒçº§ç¼“å­˜å‘½ä¸­äº†ï¼Œæ‰€ä»¥è¿”å›var1= 1ï¼›åˆ°è¿™é‡Œä¸€åˆ‡éƒ½æ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºè¿™æ—¶å€™ä¸»å†…å­˜ä¸­ä¹Ÿæ˜¯var1=1ã€‚ç„¶åçº¿ç¨‹Bä¿®æ”¹var1çš„å€¼ä¸º2ï¼Œå¹¶å°†å…¶å­˜æ”¾åˆ°çº¿ç¨‹2æ‰€åœ¨çš„ä¸€çº§Cacheå’Œå…±äº«äºŒçº§Cacheä¸­ï¼Œæœ€åæ›´æ–°ä¸»å†…å­˜ä¸­var1çš„å€¼ä¸º2ï¼Œåˆ°è¿™é‡Œä¸€åˆ‡éƒ½æ˜¯å¥½çš„ã€‚</li><li>çº¿ç¨‹Aè¿™æ¬¡åˆéœ€è¦ä¿®æ”¹var1çš„å€¼ï¼Œè·å–æ—¶ä¸€çº§ç¼“å­˜å‘½ä¸­ï¼Œå¹¶ä¸”var1=1ï¼Œåˆ°è¿™é‡Œé—®é¢˜å°±å‡ºç°äº†ï¼Œæ˜æ˜çº¿ç¨‹Bå·²ç»æŠŠvar1çš„å€¼ä¿®æ”¹ä¸ºäº†2ï¼Œä¸ºä½•çº¿ç¨‹Aè·å–çš„è¿˜æ˜¯1å‘¢ï¼Ÿè¿™å°±æ˜¯å…±äº«å˜é‡çš„å†…å­˜ä¸å¯è§é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯çº¿ç¨‹Bå†™å…¥çš„å€¼å¯¹çº¿ç¨‹Aä¸å¯è§ã€‚</li></ul><p>åœ¨javaä¸­ï¼Œvolatileå…³é”®å­—å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒæ˜¯æ€ä¹ˆè§£å†³çš„ï¼š</p><h4 id="volatileç‰¹æ€§ä¸€ï¼šä¿è¯å…±äº«å˜é‡å†…å­˜å¯è§"><a href="#volatileç‰¹æ€§ä¸€ï¼šä¿è¯å…±äº«å˜é‡å†…å­˜å¯è§" class="headerlink" title="volatileç‰¹æ€§ä¸€ï¼šä¿è¯å…±äº«å˜é‡å†…å­˜å¯è§"></a>volatileç‰¹æ€§ä¸€ï¼šä¿è¯å…±äº«å˜é‡å†…å­˜å¯è§</h4><p>volatileå…·ä½“æ˜¯æ€ä¹ˆå®ç°å…±äº«å˜é‡çº¿ç¨‹é—´å¯è§çš„å‘¢ï¼Ÿç®€å•æ¥è¯´å¯ä»¥åˆ†ä¸ºä¸¤ç‚¹ï¼š</p><ol><li><p>å½“ä¸€ä¸ªå˜é‡è¢«å£°æ˜ä¸ºvolatileæ—¶ï¼Œçº¿ç¨‹åœ¨å†™å…¥å˜é‡æ—¶ä¸ä¼šæŠŠå€¼ç¼“å­˜åœ¨å¯„å­˜å™¨æˆ–è€…å…¶ä»–åœ°æ–¹,è€Œæ˜¯ä¼šæŠŠå€¼åˆ·æ–°å›ä¸»å†…å­˜ã€‚</p></li><li><p>å½“å…¶ä»–çº¿ç¨‹è¯»å–è¯¥å…±äº«å˜é‡æ—¶ï¼Œä¼šä»ä¸»å†…å­˜é‡æ–°è·å–æœ€æ–°å€¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨å½“å‰çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­çš„å€¼ã€‚</p></li></ol><h4 id="volatileç‰¹æ€§äºŒï¼šç¦æ­¢æŒ‡ä»¤é‡æ’åº"><a href="#volatileç‰¹æ€§äºŒï¼šç¦æ­¢æŒ‡ä»¤é‡æ’åº" class="headerlink" title="volatileç‰¹æ€§äºŒï¼šç¦æ­¢æŒ‡ä»¤é‡æ’åº"></a>volatileç‰¹æ€§äºŒï¼šç¦æ­¢æŒ‡ä»¤é‡æ’åº</h4><h4 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h4><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå½“å¤šä¸ªçº¿ç¨‹æ“ä½œåŒä¸€ä¸ªå…±äº«å˜é‡çš„æ—¶å€™ï¼Œå°±æœ‰å¯èƒ½å‘ç”Ÿçº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œvolatileä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå®ƒèƒ½ä¿è¯å¯è§æ€§ï¼Œä½†æ— æ³•ä¿è¯åŸå­æ€§ã€‚</p><blockquote><p>æ‰€è°“åŸå­æ€§æ“ä½œï¼Œæ˜¯æŒ‡æ‰§è¡Œä¸€ç³»åˆ—æ“ä½œæ—¶ï¼Œè¿™äº›æ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œï¼Œä¸å­˜åœ¨åªæ‰§è¡Œå…¶ä¸­ä¸€éƒ¨åˆ†çš„æƒ…å†µã€‚</p></blockquote><p>ä»€ä¹ˆæ—¶å€™ä¸‹é€‚åˆä½¿ç”¨volatileå‘¢ï¼Ÿ</p><ol><li><p>å†™å…¥å˜é‡ä¸ä¾èµ–å˜é‡çš„å½“å‰å€¼ï¼Œä¾‹å¦‚ i ++ è¿™ç§æ“ä½œå°±ä¸é€‚åˆä½¿ç”¨volatileä¿®é¥°ï¼Œå› ä¸ºå®ƒä¾èµ– i çš„å½“å‰å€¼ï¼Œæ˜¯</p><p><strong>è·å–â€”â€”è®¡ç®—â€”â€”å†™å…¥</strong>ä¸‰æ­¥æ“ä½œï¼Œè¿™ä¸‰æ­¥æ“ä½œä¸æ˜¯åŸå­æ€§çš„ã€‚</p></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;åœ¨è®²è§£volatileä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹å†…å­˜å¯è§æ€§é—®é¢˜&lt;/p&gt;
&lt;p&gt;volatileæ˜¯javaä¸­æ¯”è¾ƒé‡è¦çš„ä¸€ä¸ªå…³é”®å­—ï¼Œå®ƒæ˜¯è½»é‡çº§é”ï¼Œæœ‰ä¸¤ä¸ªä½œç”¨&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;ä¿è¯å…±äº«å˜é‡åœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´å¯è§&lt;/li&gt;
&lt;li&gt;ç¦æ­¢æŒ‡ä»¤é‡æ’åº&lt;/li</summary>
      
    
    
    
    <category term="javaå¤šçº¿ç¨‹" scheme="http://example.com/categories/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
    
  </entry>
  
  <entry>
    <title>ThreadLocal</title>
    <link href="http://example.com/2021/06/07/ThreadLocal/"/>
    <id>http://example.com/2021/06/07/ThreadLocal/</id>
    <published>2021-06-07T07:34:22.000Z</published>
    <updated>2021-06-07T07:35:40.168Z</updated>
    
    
    
    
    <category term="javaå¤šçº¿ç¨‹" scheme="http://example.com/categories/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
    
  </entry>
  
  <entry>
    <title>å•ä¾‹æ¨¡å¼</title>
    <link href="http://example.com/2021/05/27/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
    <id>http://example.com/2021/05/27/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</id>
    <published>2021-05-27T02:59:10.000Z</published>
    <updated>2021-06-09T10:26:19.323Z</updated>
    
    <content type="html"><![CDATA[<h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p>23ç§è®¾è®¡æ¨¡å¼ä¸­ï¼Œå•ä¾‹æ¨¡å¼æ˜¯æ¯”è¾ƒç®€å•å¹¶ä¸”è¾ƒä¸ºå¸¸ç”¨çš„ä¸€ç§ã€‚</p><blockquote><p>ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼Ÿ</p><p>å•ä¾‹æ¨¡å¼çš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>é¥¿æ±‰å¼ä¸€å®šæ¯”æ‡’æ±‰å¼å·®å—ï¼Ÿ</p><p>å•ä¾‹æ¨¡å¼æ˜¯å¦å­˜åœ¨ç¼ºé™·ï¼Ÿæœ‰æ²¡æœ‰æ›¿ä»£æ–¹æ¡ˆï¼Ÿ</p></blockquote><h5 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h5><p>å®šä¹‰å¾ˆç®€å•ï¼Œä¸€ä¸ªç±»åªå…è®¸åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»å°±æ˜¯å•ä¾‹ç±»ï¼Œè¿™ç§æ¨¡å¼å°±æ˜¯å•ä¾‹æ¨¡å¼ã€‚</p><blockquote><p>å®šä¹‰ä¸­æåˆ°ï¼Œâ€œä¸€ä¸ªç±»åªå…è®¸åˆ›å»ºå”¯ä¸€ä¸€ä¸ªå¯¹è±¡â€ã€‚é‚£å¯¹è±¡çš„å”¯ä¸€æ€§çš„ä½œç”¨èŒƒå›´æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ˜¯æŒ‡çº¿ç¨‹å†…åªå…è®¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè¿˜æ˜¯æŒ‡è¿›ç¨‹å†…åªå…è®¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Ÿç­”æ¡ˆæ˜¯åè€…ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå•ä¾‹æ¨¡å¼åˆ›å»ºçš„å¯¹è±¡æ˜¯è¿›ç¨‹å”¯ä¸€çš„ã€‚å•ä¾‹ç±»ä¸­å¯¹è±¡çš„å”¯ä¸€æ€§çš„ä½œç”¨èŒƒå›´æ˜¯è¿›ç¨‹å†…çš„ï¼Œåœ¨è¿›ç¨‹é—´æ˜¯ä¸å”¯ä¸€çš„ã€‚</p></blockquote><p>æˆ‘ä»¬é‡ç‚¹çœ‹ä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å•ä¾‹è¿™ç§è®¾è®¡æ¨¡å¼ï¼Ÿå®ƒèƒ½è§£å†³å“ªäº›é—®é¢˜ï¼Ÿæ¥ä¸‹æ¥æˆ‘é€šè¿‡ä¸¤ä¸ªå®æˆ˜æ¡ˆä¾‹æ¥è®²è§£ã€‚</p><h6 id="æ¡ˆä¾‹ä¸€ï¼šå¤„ç†èµ„æºè®¿é—®å†²çª"><a href="#æ¡ˆä¾‹ä¸€ï¼šå¤„ç†èµ„æºè®¿é—®å†²çª" class="headerlink" title="æ¡ˆä¾‹ä¸€ï¼šå¤„ç†èµ„æºè®¿é—®å†²çª"></a>æ¡ˆä¾‹ä¸€ï¼šå¤„ç†èµ„æºè®¿é—®å†²çª</h6><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰å®ç°äº†ä¸€ä¸ªå¾€æ–‡ä»¶ä¸­æ‰“å°æ—¥å¿—çš„ Logger ç±»ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Logger</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> FileWriter writer;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Logger</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    File file = <span class="keyword">new</span> File(<span class="string">&quot;/Users/wangzheng/log.txt&quot;</span>);</span><br><span class="line">    writer = <span class="keyword">new</span> FileWriter(file, <span class="keyword">true</span>); <span class="comment">//trueè¡¨ç¤ºè¿½åŠ å†™å…¥</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">log</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">    writer.write(mesasge);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Loggerç±»çš„åº”ç”¨ç¤ºä¾‹ï¼š</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> Logger logger = <span class="keyword">new</span> Logger();</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">(String username, String password)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ...çœç•¥ä¸šåŠ¡é€»è¾‘ä»£ç ...</span></span><br><span class="line">    logger.log(username + <span class="string">&quot; logined!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderController</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> Logger logger = <span class="keyword">new</span> Logger();</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">create</span><span class="params">(OrderVo order)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ...çœç•¥ä¸šåŠ¡é€»è¾‘ä»£ç ...</span></span><br><span class="line">    logger.log(<span class="string">&quot;Created an order: &quot;</span> + order.toString());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¿™æ®µä»£ç æ˜¯æœ‰é—®é¢˜çš„</p><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œæ‰€æœ‰çš„æ—¥å¿—éƒ½å†™å…¥åˆ°åŒä¸€ä¸ªæ–‡ä»¶ /Users/wangzheng/log.txt ä¸­ã€‚åœ¨ UserController å’Œ OrderController ä¸­ï¼Œæˆ‘ä»¬åˆ†åˆ«åˆ›å»ºä¸¤ä¸ª Logger å¯¹è±¡ã€‚<strong>åœ¨ Web å®¹å™¨çš„ Servlet å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå¦‚æœä¸¤ä¸ª Servlet çº¿ç¨‹åŒæ—¶åˆ†åˆ«æ‰§è¡Œ login() å’Œ create() ä¸¤ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”åŒæ—¶å†™æ—¥å¿—åˆ° log.txt æ–‡ä»¶ä¸­ï¼Œé‚£å°±æœ‰å¯èƒ½å­˜åœ¨æ—¥å¿—ä¿¡æ¯äº’ç›¸è¦†ç›–çš„æƒ…å†µã€‚</strong></p><p>å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿæˆ‘ä»¬æœ€å…ˆæƒ³åˆ°çš„å¯èƒ½å°±æ˜¯åŠ é”ï¼Œç»™log()å‡½æ•°åŠ äº’æ–¥é”ï¼ŒåŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨æ‰§è¡Œ log() å‡½æ•°ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Logger</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> FileWriter writer;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Logger</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    File file = <span class="keyword">new</span> File(<span class="string">&quot;/Users/wangzheng/log.txt&quot;</span>);</span><br><span class="line">    writer = <span class="keyword">new</span> FileWriter(file, <span class="keyword">true</span>); <span class="comment">//trueè¡¨ç¤ºè¿½åŠ å†™å…¥</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">log</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">synchronized</span>(<span class="keyword">this</span>) &#123; <span class="comment">// this ä»£è¡¨å¯¹è±¡çº§åˆ«çš„é”</span></span><br><span class="line">      writer.write(mesasge);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ï¼Œè¿™çœŸçš„èƒ½è§£å†³å¤šçº¿ç¨‹å†™å…¥æ—¥å¿—æ—¶ç›¸äº’è¦†ç›–çš„é—®é¢˜å—ï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œè¿™æ˜¯å› ä¸ºï¼Œè¿™ç§é”æ˜¯ä¸€<strong>ä¸ªå¯¹è±¡çº§åˆ«</strong>çš„é”ï¼Œä¸€ä¸ªå¯¹è±¡åœ¨ä¸åŒçš„çº¿ç¨‹ä¸‹åŒæ—¶è°ƒç”¨ log() å‡½æ•°ï¼Œä¼šè¢«å¼ºåˆ¶è¦æ±‚é¡ºåºæ‰§è¡Œã€‚ä½†æ˜¯ï¼Œä¸åŒçš„å¯¹è±¡ä¹‹é—´å¹¶ä¸å…±äº«åŒä¸€æŠŠé”ã€‚åœ¨ä¸åŒçš„çº¿ç¨‹ä¸‹ï¼Œé€šè¿‡ä¸åŒçš„å¯¹è±¡è°ƒç”¨æ‰§è¡Œ log() å‡½æ•°ï¼Œé”å¹¶ä¸ä¼šèµ·ä½œç”¨ï¼Œä»ç„¶æœ‰å¯èƒ½å­˜åœ¨å†™å…¥æ—¥å¿—äº’ç›¸è¦†ç›–çš„é—®é¢˜ã€‚</p><p>å®é™…ä¸Šï¼Œè¦æƒ³è§£å†³è¿™ä¸ªé—®é¢˜ä¹Ÿä¸éš¾ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠå¯¹è±¡çº§åˆ«çš„é”ï¼Œæ¢æˆç±»çº§åˆ«çš„é”å°±å¯ä»¥äº†ã€‚è®©æ‰€æœ‰çš„å¯¹è±¡éƒ½å…±äº«åŒä¸€æŠŠé”ã€‚è¿™æ ·å°±é¿å…äº†ä¸åŒå¯¹è±¡ä¹‹é—´åŒæ—¶è°ƒç”¨ log() å‡½æ•°ï¼Œè€Œå¯¼è‡´çš„æ—¥å¿—è¦†ç›–é—®é¢˜ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Logger</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> FileWriter writer;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Logger</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    File file = <span class="keyword">new</span> File(<span class="string">&quot;/Users/wangzheng/log.txt&quot;</span>);</span><br><span class="line">    writer = <span class="keyword">new</span> FileWriter(file, <span class="keyword">true</span>); <span class="comment">//trueè¡¨ç¤ºè¿½åŠ å†™å…¥</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">log</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">synchronized</span>(Logger.class) &#123; <span class="comment">// ç±»çº§åˆ«çš„é”</span></span><br><span class="line">      writer.write(mesasge);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é™¤äº†ä½¿ç”¨<strong>ç±»çº§åˆ«é”</strong>ä¹‹å¤–ï¼Œå®é™…ä¸Šï¼Œ<strong>è§£å†³èµ„æºç«äº‰é—®é¢˜</strong>çš„åŠæ³•è¿˜æœ‰å¾ˆå¤šï¼Œ<strong>åˆ†å¸ƒå¼é”</strong>æ˜¯æœ€å¸¸å¬åˆ°çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚ä¸è¿‡ï¼Œå®ç°ä¸€ä¸ªå®‰å…¨å¯é ã€æ—  bugã€é«˜æ€§èƒ½çš„åˆ†å¸ƒå¼é”ï¼Œå¹¶ä¸æ˜¯ä»¶å®¹æ˜“çš„äº‹æƒ…ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œ<strong>å¹¶å‘é˜Ÿåˆ—</strong>ï¼ˆæ¯”å¦‚ Java ä¸­çš„ BlockingQueueï¼‰ä¹Ÿå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶å¾€å¹¶å‘é˜Ÿåˆ—é‡Œå†™æ—¥å¿—ï¼Œä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹è´Ÿè´£å°†å¹¶å‘é˜Ÿåˆ—ä¸­çš„æ•°æ®ï¼Œå†™å…¥åˆ°æ—¥å¿—æ–‡ä»¶ã€‚è¿™ç§æ–¹å¼å®ç°èµ·æ¥ä¹Ÿç¨å¾®æœ‰ç‚¹å¤æ‚ã€‚</p><p>ç›¸å¯¹äºè¿™ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼Œå•ä¾‹æ¨¡å¼çš„è§£å†³æ€è·¯å°±ç®€å•ä¸€äº›äº†ã€‚æˆ‘ä»¬å°† Logger è®¾è®¡æˆä¸€ä¸ªå•ä¾‹ç±»ï¼Œ<strong>ç¨‹åºä¸­åªå…è®¸åˆ›å»ºä¸€ä¸ª Logger å¯¹è±¡</strong>ï¼Œæ‰€æœ‰çš„çº¿ç¨‹å…±äº«ä½¿ç”¨çš„è¿™ä¸€ä¸ª Logger å¯¹è±¡ï¼Œå…±äº«ä¸€ä¸ª FileWriter å¯¹è±¡ï¼Œè€Œ FileWriter æœ¬èº«æ˜¯å¯¹è±¡çº§åˆ«çº¿ç¨‹å®‰å…¨çš„ï¼Œä¹Ÿå°±é¿å…äº†å¤šçº¿ç¨‹æƒ…å†µä¸‹å†™æ—¥å¿—ä¼šäº’ç›¸è¦†ç›–çš„é—®é¢˜ã€‚**(ä¸€ä¸ªå¯¹è±¡åœ¨ä¸åŒçš„çº¿ç¨‹ä¸‹è°ƒç”¨logï¼ˆï¼‰å‡½æ•°ï¼Œä¼šè¢«å¼ºåˆ¶è¦æ±‚é¡ºåºæ‰§è¡Œã€‚)**</p><p>æŒ‰ç…§è¿™ä¸ªè®¾è®¡æ€è·¯ï¼Œæˆ‘ä»¬å®ç°äº† Logger å•ä¾‹ç±»ã€‚å…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Logger</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> FileWriter writer;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger instance = <span class="keyword">new</span> Logger();</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">Logger</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    File file = <span class="keyword">new</span> File(<span class="string">&quot;/Users/wangzheng/log.txt&quot;</span>);</span><br><span class="line">    writer = <span class="keyword">new</span> FileWriter(file, <span class="keyword">true</span>); <span class="comment">//trueè¡¨ç¤ºè¿½åŠ å†™å…¥</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Logger <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">log</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">    writer.write(mesasge);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Loggerç±»çš„åº”ç”¨ç¤ºä¾‹ï¼š</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">(String username, String password)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ...çœç•¥ä¸šåŠ¡é€»è¾‘ä»£ç ...</span></span><br><span class="line">    Logger.getInstance().log(username + <span class="string">&quot; logined!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderController</span> </span>&#123;  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">create</span><span class="params">(OrderVo order)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ...çœç•¥ä¸šåŠ¡é€»è¾‘ä»£ç ...</span></span><br><span class="line">    Logger.getInstance().log(<span class="string">&quot;Created a order: &quot;</span> + order.toString());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="æ¡ˆä¾‹äºŒï¼šè¡¨ç¤ºå…¨å±€å”¯ä¸€ç±»"><a href="#æ¡ˆä¾‹äºŒï¼šè¡¨ç¤ºå…¨å±€å”¯ä¸€ç±»" class="headerlink" title="æ¡ˆä¾‹äºŒï¼šè¡¨ç¤ºå…¨å±€å”¯ä¸€ç±»"></a>æ¡ˆä¾‹äºŒï¼šè¡¨ç¤ºå…¨å±€å”¯ä¸€ç±»</h6><p>ä»ä¸šåŠ¡æ¦‚å¿µä¸Šï¼Œå¦‚æœæœ‰äº›æ•°æ®åœ¨ç³»ç»Ÿä¸­åªåº”ä¿å­˜ä¸€ä»½ï¼Œé‚£å°±æ¯”è¾ƒé€‚åˆè®¾è®¡ä¸ºå•ä¾‹ç±»ã€‚</p><p>æ¯”å¦‚ï¼Œé…ç½®ä¿¡æ¯ç±»ã€‚åœ¨ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå½“é…ç½®æ–‡ä»¶è¢«åŠ è½½åˆ°å†…å­˜ä¹‹åï¼Œä»¥å¯¹è±¡çš„å½¢å¼å­˜åœ¨ï¼Œä¹Ÿç†æ‰€åº”å½“åªæœ‰ä¸€ä»½ã€‚</p><p>å†æ¯”å¦‚ï¼Œå”¯ä¸€é€’å¢ ID å·ç ç”Ÿæˆå™¨ï¼Œå¦‚æœç¨‹åºä¸­æœ‰ä¸¤ä¸ªå¯¹è±¡ï¼Œé‚£å°±ä¼šå­˜åœ¨ç”Ÿæˆé‡å¤ ID çš„æƒ…å†µï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬åº”è¯¥å°† ID ç”Ÿæˆå™¨ç±»è®¾è®¡ä¸ºå•ä¾‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.atomic.AtomicLong;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IdGenerator</span> </span>&#123;</span><br><span class="line">  <span class="comment">// AtomicLongæ˜¯ä¸€ä¸ªJavaå¹¶å‘åº“ä¸­æä¾›çš„ä¸€ä¸ªåŸå­å˜é‡ç±»å‹,</span></span><br><span class="line">  <span class="comment">// å®ƒå°†ä¸€äº›çº¿ç¨‹ä¸å®‰å…¨éœ€è¦åŠ é”çš„å¤åˆæ“ä½œå°è£…ä¸ºäº†çº¿ç¨‹å®‰å…¨çš„åŸå­æ“ä½œï¼Œ</span></span><br><span class="line">  <span class="comment">// æ¯”å¦‚ä¸‹é¢ä¼šç”¨åˆ°çš„incrementAndGet().</span></span><br><span class="line">  <span class="keyword">private</span> AtomicLong id = <span class="keyword">new</span> AtomicLong(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> IdGenerator instance = <span class="keyword">new</span> IdGenerator();</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">IdGenerator</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IdGenerator <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getId</span><span class="params">()</span> </span>&#123; </span><br><span class="line">    <span class="keyword">return</span> id.incrementAndGet();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// IdGeneratorä½¿ç”¨ä¸¾ä¾‹</span></span><br><span class="line"><span class="keyword">long</span> id = IdGenerator.getInstance().getId();</span><br></pre></td></tr></table></figure><h5 id="å¦‚ä½•å®ç°ä¸€ä¸ªå•ä¾‹"><a href="#å¦‚ä½•å®ç°ä¸€ä¸ªå•ä¾‹" class="headerlink" title="å¦‚ä½•å®ç°ä¸€ä¸ªå•ä¾‹"></a>å¦‚ä½•å®ç°ä¸€ä¸ªå•ä¾‹</h5><p>è¦å®ç°ä¸€ä¸ªå•ä¾‹ï¼Œæˆ‘ä»¬éœ€è¦å…³æ³¨çš„ç‚¹æ— å¤–ä¹ä¸‹é¢å‡ ä¸ªï¼š</p><ul><li>æ„é€ å‡½æ•°éœ€è¦æ˜¯ private è®¿é—®æƒé™çš„ï¼Œè¿™æ ·æ‰èƒ½é¿å…å¤–éƒ¨é€šè¿‡ new åˆ›å»ºå®ä¾‹ï¼›</li><li>è€ƒè™‘å¯¹è±¡åˆ›å»ºæ—¶çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼›</li><li>è€ƒè™‘æ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼›</li><li>è€ƒè™‘ getInstance() æ€§èƒ½æ˜¯å¦é«˜ï¼ˆæ˜¯å¦åŠ é”ï¼‰ã€‚</li></ul><h6 id="é¥¿æ±‰å¼"><a href="#é¥¿æ±‰å¼" class="headerlink" title="é¥¿æ±‰å¼"></a>é¥¿æ±‰å¼</h6><p>é¥¿æ±‰å¼çš„å®ç°æ–¹å¼æ¯”è¾ƒç®€å•ã€‚åœ¨ç±»åŠ è½½çš„æ—¶å€™ï¼Œinstance é™æ€å®ä¾‹å°±å·²ç»åˆ›å»ºå¹¶åˆå§‹åŒ–å¥½äº†ï¼Œæ‰€ä»¥ï¼Œinstance å®ä¾‹çš„åˆ›å»ºè¿‡ç¨‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä¸è¿‡ï¼Œè¿™æ ·çš„å®ç°æ–¹å¼ä¸æ”¯æŒå»¶è¿ŸåŠ è½½ï¼ˆåœ¨çœŸæ­£ç”¨åˆ° IdGenerator çš„æ—¶å€™ï¼Œå†åˆ›å»ºå®ä¾‹ï¼‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IdGenerator</span> </span>&#123; </span><br><span class="line">  <span class="keyword">private</span> AtomicLong id = <span class="keyword">new</span> AtomicLong(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> IdGenerator instance = <span class="keyword">new</span> IdGenerator();</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">IdGenerator</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IdGenerator <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getId</span><span class="params">()</span> </span>&#123; </span><br><span class="line">    <span class="keyword">return</span> id.incrementAndGet();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡å»ï¼Œæˆ‘ä¸€ç›´è§‰å¾—é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼æ˜¯å¾ˆlowçš„å•ä¾‹ï¼Œå› ä¸ºå®ƒå®ç°èµ·æ¥å¾ˆç®€å•ï¼Œå¹¶ä¸”ä¸æ”¯æŒå»¶è¿ŸåŠ è½½ã€‚ä½†æ˜¯ï¼Œä»”ç»†æƒ³æƒ³ï¼Œé¥¿æ±‰å¼çœŸå°±ä¸å¦‚å…¶ä»–å‡ ç§å®ç°æ–¹å¼å—ï¼Ÿå¦‚æœå®ä¾‹å ç”¨èµ„æºå¤šï¼ˆæ¯”å¦‚å ç”¨å†…å­˜å¤šï¼‰æˆ–åˆå§‹åŒ–è€—æ—¶é•¿ï¼ˆæ¯”å¦‚éœ€è¦åŠ è½½å„ç§é…ç½®æ–‡ä»¶ï¼‰ï¼Œé‚£ä¹ˆæ ¹æ®fail-fast çš„è®¾è®¡åŸåˆ™ï¼ˆæœ‰é—®é¢˜åŠæ—©æš´éœ²ï¼‰ï¼Œé‚£æˆ‘ä»¬ä¹Ÿå¸Œæœ›åœ¨ç¨‹åºå¯åŠ¨æ—¶å°±å°†è¿™ä¸ªå®ä¾‹åˆå§‹åŒ–å¥½ï¼Œä»¥ä¾¿æˆ‘ä»¬åŠæ—¶ä¿®å¤ã€‚</p><h6 id="æ‡’æ±‰å¼"><a href="#æ‡’æ±‰å¼" class="headerlink" title="æ‡’æ±‰å¼"></a>æ‡’æ±‰å¼</h6><p>æ‡’æ±‰å¼ç›¸å¯¹äºé¥¿æ±‰å¼çš„ä¼˜åŠ¿æ˜¯æ”¯æŒå»¶è¿ŸåŠ è½½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IdGenerator</span> </span>&#123; </span><br><span class="line">  <span class="keyword">private</span> AtomicLong id = <span class="keyword">new</span> AtomicLong(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> IdGenerator instance;</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">IdGenerator</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> IdGenerator <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">      instance = <span class="keyword">new</span> IdGenerator();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getId</span><span class="params">()</span> </span>&#123; </span><br><span class="line">    <span class="keyword">return</span> id.incrementAndGet();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="åŒé‡æ£€æµ‹"><a href="#åŒé‡æ£€æµ‹" class="headerlink" title="åŒé‡æ£€æµ‹"></a>åŒé‡æ£€æµ‹</h6><p>åŒé‡æ£€æµ‹æ¨¡å¼æ˜¯å¯¹é¥¿æ±‰å¼ã€æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ç¼ºé™·çš„è¡¥å……ï¼Œé¥¿æ±‰å¼ä¸æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Œæ‡’æ±‰å¼ç”±äºåŠ äº†ä¸€æŠŠå¤§é”ï¼Œå¦‚æœé¢‘ç¹ä½¿ç”¨è¿™ä¸ªç±»ï¼Œé‚£é¢‘ç¹åŠ é”ã€é‡Šæ”¾é”åŠå¹¶å‘åº¦ä½ç­‰é—®é¢˜ï¼Œä¼šå¯¼è‡´æ€§èƒ½ç“¶é¢ˆï¼Œæ‰€ä»¥å°±æœ‰äº†åŒé‡æ£€æµ‹æ¨¡å¼ï¼Œæ—¢æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Œåˆæ”¯æŒé«˜å¹¶å‘çš„å•ä¾‹å®ç°æ–¹å¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IdGenerator</span> </span>&#123; </span><br><span class="line">  <span class="keyword">private</span> AtomicLong id = <span class="keyword">new</span> AtomicLong(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> IdGenerator instance;</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">IdGenerator</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IdGenerator <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123; <span class="comment">// ç¬¬ä¸€é‡æ£€æµ‹ï¼Œå¦‚æœ==nullï¼ŒåŠ é”</span></span><br><span class="line">      <span class="keyword">synchronized</span>(IdGenerator.class) &#123; <span class="comment">// ç±»çº§åˆ«çš„é”</span></span><br><span class="line">       <span class="keyword">if</span>ï¼ˆinstance == <span class="keyword">null</span>ï¼‰ &#123; <span class="comment">// ç¬¬äºŒé‡æ£€æµ‹</span></span><br><span class="line">          instance = <span class="keyword">new</span> IdGenerator();</span><br><span class="line">          &#125;</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getId</span><span class="params">()</span> </span>&#123; </span><br><span class="line">    <span class="keyword">return</span> id.incrementAndGet();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="é™æ€å†…éƒ¨ç±»"><a href="#é™æ€å†…éƒ¨ç±»" class="headerlink" title="é™æ€å†…éƒ¨ç±»"></a>é™æ€å†…éƒ¨ç±»</h6><p>æœ‰ç‚¹ç±»ä¼¼äºé¥¿æ±‰å¼ï¼Œä½†åˆèƒ½åšåˆ°å»¶è¿ŸåŠ è½½</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IdGenerator</span> </span>&#123; </span><br><span class="line">  <span class="keyword">private</span> AtomicLong id = <span class="keyword">new</span> AtomicLong(<span class="number">0</span>);</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">IdGenerator</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonHolder</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> IdGenerator instance = <span class="keyword">new</span> IdGenerator();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IdGenerator <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> SingletonHolder.instance;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getId</span><span class="params">()</span> </span>&#123; </span><br><span class="line">    <span class="keyword">return</span> id.incrementAndGet();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>SingletonHolder æ˜¯ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ï¼Œå½“å¤–éƒ¨ç±» IdGenerator è¢«åŠ è½½çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šåˆ›å»º SingletonHolder å®ä¾‹å¯¹è±¡ã€‚åªæœ‰å½“è°ƒç”¨ getInstance() æ–¹æ³•æ—¶ï¼ŒSingletonHolder æ‰ä¼šè¢«åŠ è½½ï¼Œè¿™ä¸ªæ—¶å€™æ‰ä¼šåˆ›å»º instanceã€‚instance çš„å”¯ä¸€æ€§ã€åˆ›å»ºè¿‡ç¨‹çš„çº¿ç¨‹å®‰å…¨æ€§ï¼Œéƒ½ç”± JVM æ¥ä¿è¯ã€‚æ‰€ä»¥ï¼Œè¿™ç§å®ç°æ–¹æ³•æ—¢ä¿è¯äº†çº¿ç¨‹å®‰å…¨ï¼Œåˆèƒ½åšåˆ°å»¶è¿ŸåŠ è½½ã€‚</p><h6 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾"></a>æšä¸¾</h6><p>æšä¸¾æœ¬èº«çš„ç‰¹æ€§ï¼Œä¿è¯äº†å®ä¾‹åˆ›å»ºçš„çº¿ç¨‹å®‰å…¨æ€§å’Œå®ä¾‹çš„å”¯ä¸€æ€§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">IdGenerator</span> </span>&#123;</span><br><span class="line">  INSTANCE;</span><br><span class="line">  <span class="keyword">private</span> AtomicLong id = <span class="keyword">new</span> AtomicLong(<span class="number">0</span>);</span><br><span class="line"> </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getId</span><span class="params">()</span> </span>&#123; </span><br><span class="line">    <span class="keyword">return</span> id.incrementAndGet();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h4&gt;&lt;p&gt;23ç§è®¾è®¡æ¨¡å¼ä¸­ï¼Œå•ä¾‹æ¨¡å¼æ˜¯æ¯”è¾ƒç®€å•å¹¶ä¸”è¾ƒä¸ºå¸¸ç”¨çš„ä¸€ç§ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å•ä¾‹æ¨¡å¼çš„</summary>
      
    
    
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="http://example.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
  </entry>
  
  <entry>
    <title>åŠ¨æ€ä»£ç†</title>
    <link href="http://example.com/2021/05/25/%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/"/>
    <id>http://example.com/2021/05/25/%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/</id>
    <published>2021-05-25T09:53:05.000Z</published>
    <updated>2021-05-27T09:08:17.883Z</updated>
    
    <content type="html"><![CDATA[<h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p>å¦‚æœæœ‰ä¸€ä¸ªHelloæ¥å£ï¼Œæˆ‘ä»¬éœ€è¦å®ç°è¿™ä¸ªæ¥å£ï¼Œé€šå¸¸æƒ…å†µä¸‹æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Hello</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">sayHello</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloImpl</span> <span class="keyword">implements</span> <span class="title">Hello</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayHello</span> <span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„HelloImpl.javaæ–‡ä»¶æ˜¯ç”±å¼€å‘äººå‘˜ç¼–å†™çš„ï¼Œè€ŒåŠ¨æ€ä»£ç†è¦å¹²çš„äº‹å°±æ˜¯æˆ‘<strong>ä¸å†™è¿™ä¸ª.javaæ–‡ä»¶ä¹Ÿèƒ½ç”Ÿæˆå®ç°ç±»</strong>ï¼Œç›´æ¥è·³è¿‡ç¼–è¯‘ï¼Œç”Ÿæˆå®ç°ç±»çš„classæ–‡ä»¶ã€‚</p><p>javaç±»çš„åŠ è½½è¿‡ç¨‹å¦‚å›¾:</p><p><img src="/2021/05/25/%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/proxy1.png" alt="proxy1"></p><h4 id="javassistå®ç°åŠ¨æ€ä»£ç†"><a href="#javassistå®ç°åŠ¨æ€ä»£ç†" class="headerlink" title="javassistå®ç°åŠ¨æ€ä»£ç†"></a>javassistå®ç°åŠ¨æ€ä»£ç†</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyFactory</span> </span>&#123;</span><br><span class="line"><span class="comment">// ç®€å•å®ç°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Hello <span class="title">createProxy1</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ClassPool pool = <span class="keyword">new</span> ClassPool();</span><br><span class="line">        pool.appendSystemPath();</span><br><span class="line">      <span class="comment">// åˆ›å»ºä»£ç†ç±»</span></span><br><span class="line">        CtClass impl = pool.makeClass(<span class="string">&quot;$proxy&quot;</span>);</span><br><span class="line">      <span class="comment">// å®ç°æ¥å£</span></span><br><span class="line">        impl.addInterface(pool.get(Hello.class.getName()));</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–¹æ³•</span></span><br><span class="line">        CtMethod sayHello = CtNewMethod.make(CtClass.voidType, <span class="string">&quot;sayHello&quot;</span>, <span class="keyword">new</span> CtClass[]&#123;&#125;,</span><br><span class="line">                <span class="keyword">new</span> CtClass[<span class="number">0</span>], <span class="string">&quot;&#123;System.out.println(\&quot;hello world\&quot;);&#125;&quot;</span>,</span><br><span class="line">                impl);</span><br><span class="line">        impl.addMethod(sayHello);</span><br><span class="line"><span class="comment">// ç”Ÿæˆclassæ–‡ä»¶</span></span><br><span class="line">        Class aClass = pool.toClass(impl);</span><br><span class="line">        <span class="keyword">return</span> (Hello) aClass.newInstance();</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">   <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Hello</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">sayHello</span><span class="params">()</span></span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Hello proxy1 = createProxy1();</span><br><span class="line">        proxy1.sayHello();  <span class="comment">//  è¿è¡Œç»“æœ: hello world</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šä»£ç å°±æ˜¯ä½¿ç”¨javassistæŠ€æœ¯å®ç°çš„åŠ¨æ€ä»£ç†demoï¼Œä»è¿™ä¸ªdemoä¸­å¯ä»¥å¾ˆæ˜äº†çš„çœ‹åˆ°ï¼Œæˆ‘ä»¬æ²¡æœ‰åˆ›å»ºHelloæ¥å£çš„å®ç°ç±»ï¼Œè€Œæ˜¯ç›´æ¥ç»„è£…äº†Helloæ¥å£å®ç°ç±»çš„<strong>å­—èŠ‚ç æ–‡ä»¶</strong>ï¼ŒåŠ¨æ€ä»£ç†åšåˆ°äº†å³ä½¿æ²¡æœ‰.javaæ–‡ä»¶ï¼Œæˆ‘ä¹Ÿå¯ä»¥ç”Ÿæˆclassæ–‡ä»¶ï¼Œå®Œå…¨ä¸å½±å“æˆ‘ç¨‹åºçš„è¿è¡Œã€‚</p><p>ä½†æ˜¯ï¼Œä¸Šé¢çš„ä»£ç è¿˜æœ‰å¾ˆå¤šç¼ºé™·ï¼Œå†™çš„å¾ˆæ­»æ¿ï¼Œæ¯”å¦‚æˆ‘æ¢ä¸ªåˆ«çš„æ¥å£ï¼ŒHello1ï¼ŒHello2ç­‰ç­‰ï¼Œæˆ–è€…è¿˜æ˜¯å®ç°Helloæ¥å£ï¼Œä½†æ˜¯æ–¹æ³•æœ‰å˜äº†ï¼Œæœ‰äº›æ–¹æ³•æœ‰è¿”å›å€¼ï¼Œæœ‰äº›æœ‰å‚æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Hello</span> </span>&#123;</span><br><span class="line">     <span class="function"><span class="keyword">void</span> <span class="title">sayHello</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function">String <span class="title">getName</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">sayByeBye</span><span class="params">(String username)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æƒ³æƒ³ï¼Œè¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬æ€ä¹ˆåŠæ‰å¥½ï¼Ÿæ ¹æ®æ–¹æ³•åä¸€ä¸ªä¸ªåˆ¤æ–­ï¼Ÿè¿™æ˜¾ç„¶æ˜¯ä¸è¡Œçš„ï¼Œåˆ°åº•æ€ä¹ˆåŠæ‰å¥½ï¼Ÿè¯´åˆ°åŠ¨æ€ä»£ç†ï¼Œè®°ä¸è®°å¾—è¿™ä¹ˆä¸ªä¸œè¥¿ï¼Œå®ƒå« InvocationHandlerï¼Œæ˜¯ä¸ªæ¥å£ï¼Œä¹‹å‰ä¸€ç›´ä¸æ˜ç™½è¿™ä¸ªæ¥å£çš„ä½œç”¨ã€‚å…¶å®ï¼ŒInvocationHandlerçš„ä½œç”¨æ˜¯å°†æˆ‘ä»¬è¦ä»£ç†çš„æ¥å£çš„æ–¹æ³•æŠ½è±¡å‡ºæ¥ï¼Œæˆ‘ä»¬å®ç°InvocationHandleræ¥å£ï¼Œå…¶å®å°±æ˜¯åœ¨å®ç°åŠ¨æ€ä»£ç†è¿‡ç¨‹ä¸­æˆ‘ä»¬æ‰€è¦å¢å¼ºçš„ä¸šåŠ¡é€»è¾‘ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">InvocationHandler</span> </span>&#123;</span><br><span class="line">     <span class="comment">// proxy ä»£ç†ç±»</span></span><br><span class="line">   <span class="comment">// method æ–¹æ³•å</span></span><br><span class="line">     <span class="comment">// args æ–¹æ³•å‚æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> Throwable</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹ï¼Œjavassistæ¯”è¾ƒå®Œæ•´çš„åŠ¨æ€ä»£ç†æ˜¯å¦‚ä½•å®ç°çš„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyFactory</span> </span>&#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> cla     è¢«ä»£ç†æ¥å£</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> handler æ¥å£å…·ä½“å®ç°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">T <span class="title">createProxy</span><span class="params">(Class&lt;T&gt; cla, InvocationHandler handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªç±»</span></span><br><span class="line">        ClassPool pool = <span class="keyword">new</span> ClassPool();</span><br><span class="line">        pool.appendSystemPath(); <span class="comment">// ç›¸å½“äºclassLoader</span></span><br><span class="line">        CtClass impl = pool.makeClass(<span class="string">&quot;$proxy&quot;</span>);</span><br><span class="line">        impl.addInterface(pool.get(cla.getName()));</span><br><span class="line">        <span class="comment">// ç»™ä»£ç†ç±»æ·»åŠ å±æ€§handler</span></span><br><span class="line">        CtField field = CtField.make(<span class="string">&quot;public com.github.yeecode.mybatisdemo.ProxyFactory.InvocationHandler handler=null;&quot;</span>, impl);</span><br><span class="line">        impl.addField(field);</span><br><span class="line">        String src = <span class="string">&quot;return ($r)this.handler.invoke(\&quot;%s\&quot;,$args);&quot;</span>;</span><br><span class="line">        String voidSrc = <span class="string">&quot;this.handler.invoke(\&quot;%s\&quot;,$args);&quot;</span>;</span><br><span class="line">        <span class="comment">// åˆ›å»ºæ¥å£ä¸‹çš„æ‰€æœ‰æ–¹æ³•å®ç°</span></span><br><span class="line">        <span class="keyword">for</span> (Method method : cla.getMethods()) &#123;</span><br><span class="line">            CtClass returnType = pool.get(method.getReturnType().getName());</span><br><span class="line">            String name = method.getName();</span><br><span class="line">            CtClass[] parameters = toCtClass(pool, method.getParameterTypes());</span><br><span class="line">            CtClass[] errors = toCtClass(pool, method.getExceptionTypes());</span><br><span class="line">            String srcImpl = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span> (method.getReturnType().equals(Void.class)) &#123;</span><br><span class="line">                srcImpl = voidSrc;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                srcImpl = src;</span><br><span class="line">            &#125;</span><br><span class="line">            CtMethod newMethod =</span><br><span class="line">                    CtNewMethod.make(returnType, name, parameters, errors, String.format(srcImpl, name), impl);</span><br><span class="line">            impl.addMethod(newMethod);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å®ä¾‹åŒ–</span></span><br><span class="line">        Class aClass = pool.toClass(impl);</span><br><span class="line">        Object o = aClass.newInstance();</span><br><span class="line">        aClass.getField(<span class="string">&quot;handler&quot;</span>).set(o, handler);</span><br><span class="line">        <span class="keyword">return</span> (T) o;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// è‡ªå·±çš„InvocationHandler</span></span><br><span class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">InvocationHandler</span> </span>&#123;</span><br><span class="line">        <span class="function">Object <span class="title">invoke</span><span class="params">(String methodName, Object args[])</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//  Helloæ¥å£</span></span><br><span class="line">     <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Hello</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">sayHello</span><span class="params">()</span></span>;</span><br><span class="line">        <span class="function">String <span class="title">getName</span><span class="params">()</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        InvocationHandler handler = <span class="keyword">new</span> InvocationHandler() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(String methodName, Object[] args)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (methodName.equals(<span class="string">&quot;sayHello&quot;</span>)) &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;hello i am your friends.&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (methodName.equals(<span class="string">&quot;getName&quot;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&quot;dly&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        Hello proxy = createProxy(Hello.class, handler);</span><br><span class="line">        System.out.println(proxy.getName());  <span class="comment">// dly </span></span><br><span class="line">        proxy.sayHello(); <span class="comment">// hello i am your friends.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œæˆ‘ä»¬å¯ä»¥å°†javassistç”Ÿæˆçš„classæ–‡ä»¶ä¿å­˜ä¸‹æ¥ï¼Œçœ‹çœ‹å…¶ä¸­çš„ç±»ç»“æ„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">byte</span>[] bytes = impl.toBytecode();</span><br><span class="line">        Files.write(Paths.get(System.getProperty(<span class="string">&quot;user.dir&quot;</span>) + <span class="string">&quot;/target/&quot;</span> + impl.getName() + <span class="string">&quot;.class&quot;</span>), bytes);</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.github.yeecode.mybatisdemo.ProxyFactory.Hello;</span><br><span class="line"><span class="keyword">import</span> com.github.yeecode.mybatisdemo.ProxyFactory.InvocationHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> $<span class="title">proxy</span> <span class="keyword">implements</span> <span class="title">Hello</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> InvocationHandler handler = <span class="keyword">null</span>;  <span class="comment">// ä»£ç†ç±»ä¸­æ·»åŠ äº†InvocationHandlerå±æ€§</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (String)<span class="keyword">this</span>.handler.invoke(<span class="string">&quot;getName&quot;</span>, <span class="keyword">new</span> Object[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayHello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.handler.invoke(<span class="string">&quot;sayHello&quot;</span>, <span class="keyword">new</span> Object[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> $proxy() &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="jdkå®ç°åŠ¨æ€ä»£ç†"><a href="#jdkå®ç°åŠ¨æ€ä»£ç†" class="headerlink" title="jdkå®ç°åŠ¨æ€ä»£ç†"></a>jdkå®ç°åŠ¨æ€ä»£ç†</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Proxy</span> <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment">  * <span class="doctag">@loader</span>  ç±»åŠ è½½å™¨</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@interfaces</span>  è¢«ä»£ç†çš„æ¥å£</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@h</span> InvocationHandlerå®ç°ç±»ï¼Œåœ¨æ­¤ç±»ä¸­å®ç°ä¸šåŠ¡å¢å¼ºé€»è¾‘</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">newProxyInstance</span><span class="params">(ClassLoader loader,</span></span></span><br><span class="line"><span class="function"><span class="params">                                          Class&lt;?&gt;[] interfaces,</span></span></span><br><span class="line"><span class="function"><span class="params">                                          InvocationHandler h)</span></span></span><br><span class="line"><span class="function">  &#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">InvocationHandler</span> </span>&#123;</span><br><span class="line">  <span class="comment">/** </span></span><br><span class="line"><span class="comment">  * <span class="doctag">@proxy</span>  ç”Ÿæˆçš„ä»£ç†å¯¹è±¡ï¼Œå¯ä»¥è¿”å›</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@method</span> è¢«ä»£ç†çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@args</span> æ–¹æ³•å‚æ•°</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> Throwable</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Hello proxy = (Hello) Proxy.newProxyInstance(ProxyFactory.class.getClassLoader(),</span><br><span class="line">                <span class="keyword">new</span> Class[]&#123;Hello.class&#125;,</span><br><span class="line">                <span class="keyword">new</span> java.lang.reflect.InvocationHandler() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                        System.out.println(proxy.getClass());</span><br><span class="line">                        System.out.println(args);</span><br><span class="line">                        <span class="keyword">if</span> (method.getName().equals(<span class="string">&quot;sayHello&quot;</span>)) &#123;</span><br><span class="line">                            System.out.println(<span class="string">&quot;nihao&quot;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">        proxy.sayHello();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Hello</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">sayHello</span><span class="params">()</span></span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><blockquote><p>class com.sun.proxy.$Proxy0<br>null<br>nihao</p></blockquote><p>jdkæŸ¥çœ‹classæ–‡ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String s = <span class="string">&quot;$jdkProxy.class&quot;</span>;</span><br><span class="line"><span class="keyword">byte</span>[] bytes = ProxyGenerator.generateProxyClass(s, <span class="keyword">new</span> Class[]&#123;Hello.class&#125;);</span><br><span class="line">Files.write(Paths.get(System.getProperty(<span class="string">&quot;user.dir&quot;</span>) + <span class="string">&quot;/target/&quot;</span>+s), bytes);</span><br></pre></td></tr></table></figure><h4 id="åŠ¨æ€ä»£ç†çš„åº”ç”¨"><a href="#åŠ¨æ€ä»£ç†çš„åº”ç”¨" class="headerlink" title="åŠ¨æ€ä»£ç†çš„åº”ç”¨"></a>åŠ¨æ€ä»£ç†çš„åº”ç”¨</h4><p>åŠ¨æ€ä»£ç†çš„åº”ç”¨å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯å¢å¼ºè¡Œä»£ç†ï¼Œä¸€ç±»æ˜¯é“¾æ¥å‹ä»£ç†ï¼Œå®ƒä¿©çš„åŒºåˆ«åœ¨äºæœ‰æ²¡æœ‰æ”¹å˜ä¸šåŠ¡é€»è¾‘ï¼Œå¦‚æœæ”¹äº†å°±æ˜¯å¢å¼ºå‹ï¼Œæ²¡æœ‰å°±æ˜¯é“¾æ¥å‹ã€‚</p><p>å¢å¼ºå‹ä»£ç†</p><blockquote><p>AOP</p><p>æ—¥å¿—æ‰“å°</p><p>å£°æ˜å¼äº‹åŠ¡</p><p>ç›‘æ§</p></blockquote><p>é“¾æ¥å‹ä»£ç†</p><blockquote><p>è¿œç¨‹è°ƒç”¨</p><p>Mybatis mapper æ˜ å°„</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h4&gt;&lt;p&gt;å¦‚æœæœ‰ä¸€ä¸ªHelloæ¥å£ï¼Œæˆ‘ä»¬éœ€è¦å®ç°è¿™ä¸ªæ¥å£ï¼Œé€šå¸¸æƒ…å†µä¸‹æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;</summary>
      
    
    
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="http://example.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
  </entry>
  
  <entry>
    <title>è´£ä»»é“¾æ¨¡å¼</title>
    <link href="http://example.com/2021/05/20/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/"/>
    <id>http://example.com/2021/05/20/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/</id>
    <published>2021-05-20T03:17:45.000Z</published>
    <updated>2021-05-25T07:28:53.216Z</updated>
    
    <content type="html"><![CDATA[<p>ä¼—å¤šä¼˜ç§€çš„å¼€æºæ¡†æ¶ä¸­ï¼Œå…¶æºç å¤§é‡ä½¿ç”¨äº†è®¾è®¡æ¨¡å¼ï¼Œå…¶ä¸­è´£ä»»é“¾æ¨¡å¼æ˜¯æ¯”è¾ƒé‡è¦å¹¶ä¸”è¢«å¹¿æ³›ä½¿ç”¨çš„ï¼Œå¦‚æœå¯¹è®¾è®¡æ¨¡å¼ä¸æ¸…æ¥šï¼Œåœ¨é˜…è¯»æºç çš„è¿‡ç¨‹ä¸­å°±å¾ˆå®¹æ˜“è¿·å¤±æ–¹å‘ã€‚</p><h4 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h4><p>è´£ä»»é“¾æ¨¡å¼æ˜¯ä»€ä¹ˆï¼Ÿ</p><blockquote><p>è¿™ç§æ¨¡å¼åœ¨ç»“æ„ä¸Šç”±å¤šä¸ªéƒ¨ä»¶ã€åŸºäºå¼•ç”¨ç»„æˆä¸€ä¸²é“¾æ¡ï¼Œè¡Œä¸ºä¸Šè¯·æ±‚ä»é“¾æ¡çš„å¤´éƒ¨ä¼ é€’åˆ°å„ä¸ªèŠ‚ç‚¹ï¼Œä»è€Œè§¦å‘æ‰§è¡Œå„ä¸ªèŠ‚ç‚¹æ‰€è¦è´Ÿè´£çš„ä¸šåŠ¡é€»è¾‘ã€‚</p><p>è´£ä»»é“¾ç”±å¤šä¸ªèŠ‚ç‚¹ï¼ˆå¤„ç†å™¨ï¼‰ç»„æˆã€‚åœ¨è¡Œä¸ºæ¨¡å¼ä¸Šæœ‰ä¸¤ç§ï¼šä¸€ç§ä½¿éå†é“¾æ¡ä¸Šçš„èŠ‚ç‚¹ï¼Œç›´åˆ°æ‰¾åˆ°å¯¹åº”çš„èŠ‚ç‚¹ï¼Œç„¶åå¤„ç†ï¼Œè¿™ç§äº¤ç»å…¸è´£ä»»é“¾æ¨¡å¼ã€‚</p><p>å¦ä¸€ç§æ˜¯ç”±å„ä¸ªèŠ‚ç‚¹ä¾æ¬¡å¤„ç†ï¼Œå…±äº«è´Ÿæ‹…è´£ä»»çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬ç§°å®ƒä¸ºå˜ç§è´£ä»»é“¾ã€‚ä¸¤ç§æ¨¡å¼åœ¨ç»“æ„ä¸Šä¹Ÿä¼šä¸ä¸€æ ·ï¼Œå‰è€…åŸºäºæ•°ç»„è¿›è¡Œéå†ï¼Œåè€…é€šè¿‡å¼•ç”¨ç»„æˆé“¾è¡¨ã€‚</p></blockquote><h4 id="mybatisç¼“å­˜ç¤ºä¾‹"><a href="#mybatisç¼“å­˜ç¤ºä¾‹" class="headerlink" title="mybatisç¼“å­˜ç¤ºä¾‹"></a>mybatisç¼“å­˜ç¤ºä¾‹</h4><p>åœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œç¼“å­˜æ˜¯æ¯”è¾ƒå¸¸è§çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œé€šå¸¸æƒ…å†µä¸‹è¯·æ±‚æ•°æ®æ˜¯ä»æ•°æ®åº“è¯»å–çš„ï¼Œä¸ºäº†åŠ å¿«å“åº”é€Ÿåº¦ï¼Œæˆ‘ä»¬å¼•å…¥ç¼“å­˜ï¼Œè¯·æ±‚æ•°æ®ç›´æ¥ä»å†…å­˜è¿”å›ã€‚</p><p>ä¸€ä¸ªç¼“å­˜ç»„ä»¶ï¼Œå…¶åŠŸèƒ½ä¸»è¦æ˜¯å­˜å‚¨ã€è·å–ï¼Œè¾…åŠ©åŠŸèƒ½å¯ä»¥åŒ…æ‹¬è¿‡æœŸåˆ é™¤ã€çº¿ç¨‹å®‰å…¨ã€åºåˆ—åŒ–ã€å‘½ä¸­ç‡ç»Ÿè®¡ç­‰ç­‰ã€‚</p><p>mybatisä¸­çš„ç¼“å­˜å®ç°é‡‡ç”¨çš„å°±æ˜¯è´£ä»»é“¾æ¨¡å¼ï¼Œmybatisç¼“å­˜æ˜¯é€šè¿‡åŠ è½½ã€è§£æé…ç½®æ–‡ä»¶ï¼Œç”±Configurationç®¡ç†çš„ã€‚ä¸‹é¢æˆ‘ä»¬å°±çœ‹çœ‹mybatisç¼“å­˜è®¾è®¡å®ç°çš„æºç ï¼š</p><p>é¦–å…ˆè§£æé…ç½®æ–‡ä»¶ï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XMLConfigBuilder</span> <span class="keyword">extends</span> <span class="title">BaseBuilder</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> parsed;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> XPathParser parser;</span><br><span class="line">    <span class="keyword">private</span> String environment;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ReflectorFactory localReflectorFactory;</span><br><span class="line"><span class="comment">// è¯¥æ–¹æ³•ç”¨æ¥è§£æé…ç½®æ–‡ä»¶</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">parseConfiguration</span><span class="params">(XNode root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.propertiesElement(root.evalNode(<span class="string">&quot;properties&quot;</span>));</span><br><span class="line">            Properties settings = <span class="keyword">this</span>.settingsAsProperties(root.evalNode(<span class="string">&quot;settings&quot;</span>));</span><br><span class="line">            <span class="keyword">this</span>.loadCustomVfs(settings);</span><br><span class="line">            <span class="keyword">this</span>.loadCustomLogImpl(settings);</span><br><span class="line">            <span class="keyword">this</span>.typeAliasesElement(root.evalNode(<span class="string">&quot;typeAliases&quot;</span>));</span><br><span class="line">            <span class="keyword">this</span>.pluginElement(root.evalNode(<span class="string">&quot;plugins&quot;</span>));</span><br><span class="line">            <span class="keyword">this</span>.objectFactoryElement(root.evalNode(<span class="string">&quot;objectFactory&quot;</span>));</span><br><span class="line">            <span class="keyword">this</span>.objectWrapperFactoryElement(root.evalNode(<span class="string">&quot;objectWrapperFactory&quot;</span>));</span><br><span class="line">            <span class="keyword">this</span>.reflectorFactoryElement(root.evalNode(<span class="string">&quot;reflectorFactory&quot;</span>));</span><br><span class="line">            <span class="keyword">this</span>.settingsElement(settings);</span><br><span class="line">            <span class="keyword">this</span>.environmentsElement(root.evalNode(<span class="string">&quot;environments&quot;</span>));</span><br><span class="line">            <span class="keyword">this</span>.databaseIdProviderElement(root.evalNode(<span class="string">&quot;databaseIdProvider&quot;</span>));</span><br><span class="line">            <span class="keyword">this</span>.typeHandlerElement(root.evalNode(<span class="string">&quot;typeHandlers&quot;</span>));</span><br><span class="line">            <span class="comment">// è§£æmappersæ ‡ç­¾ï¼Œç¼“å­˜å®ç°åœ¨è¿™é‡Œé¢</span></span><br><span class="line">           <span class="keyword">this</span>.mapperElement(root.evalNode(<span class="string">&quot;mappers&quot;</span>)); </span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception var3) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> BuilderException(<span class="string">&quot;Error parsing SQL Mapper Configuration. Cause: &quot;</span> + var3, var3);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">mapperElement</span><span class="params">(XNode parent)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">     <span class="keyword">if</span> (resource != <span class="keyword">null</span> &amp;&amp; url == <span class="keyword">null</span> &amp;&amp; mapperClass == <span class="keyword">null</span>) &#123;</span><br><span class="line">                            ErrorContext.instance().resource(resource);</span><br><span class="line">                            inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">                            mapperParser = <span class="keyword">new</span> XMLMapperBuilder(inputStream, <span class="keyword">this</span>.configuration, resource, <span class="keyword">this</span>.configuration.getSqlFragments());</span><br><span class="line">                            mapperParser.parse();  <span class="comment">// è§£æmapperæ–‡ä»¶å…¥å£</span></span><br><span class="line">                        &#125; </span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>è§£æmapperæ–‡ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XMLMapperBuilder</span> <span class="keyword">extends</span> <span class="title">BaseBuilder</span> </span>&#123;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">parse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">this</span>.configuration.isResourceLoaded(<span class="keyword">this</span>.resource)) &#123;</span><br><span class="line">            <span class="keyword">this</span>.configurationElement(<span class="keyword">this</span>.parser.evalNode(<span class="string">&quot;/mapper&quot;</span>)); <span class="comment">// å…¥å£</span></span><br><span class="line">            <span class="keyword">this</span>.configuration.addLoadedResource(<span class="keyword">this</span>.resource);</span><br><span class="line">            <span class="keyword">this</span>.bindMapperForNamespace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.parsePendingResultMaps();</span><br><span class="line">        <span class="keyword">this</span>.parsePendingCacheRefs();</span><br><span class="line">        <span class="keyword">this</span>.parsePendingStatements();</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">configurationElement</span><span class="params">(XNode context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String namespace = context.getStringAttribute(<span class="string">&quot;namespace&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (namespace != <span class="keyword">null</span> &amp;&amp; !namespace.equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">                <span class="keyword">this</span>.builderAssistant.setCurrentNamespace(namespace);</span><br><span class="line">                <span class="keyword">this</span>.cacheRefElement(context.evalNode(<span class="string">&quot;cache-ref&quot;</span>));</span><br><span class="line">                <span class="comment">// åœ¨è§£æcacheæ ‡ç­¾</span></span><br><span class="line">                <span class="keyword">this</span>.cacheElement(context.evalNode(<span class="string">&quot;cache&quot;</span>)); </span><br><span class="line">                <span class="keyword">this</span>.parameterMapElement(context.evalNodes(<span class="string">&quot;/mapper/parameterMap&quot;</span>));</span><br><span class="line">                <span class="keyword">this</span>.resultMapElements(context.evalNodes(<span class="string">&quot;/mapper/resultMap&quot;</span>));</span><br><span class="line">                <span class="keyword">this</span>.sqlElement(context.evalNodes(<span class="string">&quot;/mapper/sql&quot;</span>));</span><br><span class="line">                <span class="keyword">this</span>.buildStatementFromContext(context.evalNodes(<span class="string">&quot;select|insert|update|delete&quot;</span>));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> BuilderException(<span class="string">&quot;Mapper&#x27;s namespace cannot be empty&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception var3) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> BuilderException(<span class="string">&quot;Error parsing Mapper XML. The XML location is &#x27;&quot;</span> + <span class="keyword">this</span>.resource + <span class="string">&quot;&#x27;. Cause: &quot;</span> + var3, var3);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿™ä¸ªæ–¹æ³•ç”¨æ¥è®¾ç½®ç¼“å­˜å‚æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">cacheElement</span><span class="params">(XNode context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (context != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">// PERPETUAL ä»£è¡¨ä½¿ç”¨cacheæ¥å£å®ç°ç±» PerpetualCache</span></span><br><span class="line">            String type = context.getStringAttribute(<span class="string">&quot;type&quot;</span>, <span class="string">&quot;PERPETUAL&quot;</span>);</span><br><span class="line">            Class&lt;? extends Cache&gt; typeClass = <span class="keyword">this</span>.typeAliasRegistry.resolveAlias(type);</span><br><span class="line">            <span class="comment">// LRU  cacheæ·˜æ±°æœºåˆ¶å®ç°ç±»   é»˜è®¤æ˜¯FifoCache</span></span><br><span class="line">            String eviction = context.getStringAttribute(<span class="string">&quot;eviction&quot;</span>, <span class="string">&quot;LRU&quot;</span>);</span><br><span class="line">            Class&lt;? extends Cache&gt; evictionClass = <span class="keyword">this</span>.typeAliasRegistry.resolveAlias(eviction);</span><br><span class="line">            Long flushInterval = context.getLongAttribute(<span class="string">&quot;flushInterval&quot;</span>);</span><br><span class="line">            Integer size = context.getIntAttribute(<span class="string">&quot;size&quot;</span>);</span><br><span class="line">            <span class="keyword">boolean</span> readWrite = !context.getBooleanAttribute(<span class="string">&quot;readOnly&quot;</span>, <span class="keyword">false</span>);</span><br><span class="line">            <span class="keyword">boolean</span> blocking = context.getBooleanAttribute(<span class="string">&quot;blocking&quot;</span>, <span class="keyword">false</span>);</span><br><span class="line">            Properties props = context.getChildrenAsProperties();</span><br><span class="line">           <span class="comment">// æ„å»ºç¼“å­˜</span></span><br><span class="line">          <span class="keyword">this</span>.builderAssistant.useNewCache(typeClass, evictionClass, flushInterval, size, readWrite, blocking, props);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MapperBuilderAssistant</span> <span class="keyword">extends</span> <span class="title">BaseBuilder</span> </span>&#123;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> Cache <span class="title">useNewCache</span><span class="params">(Class&lt;? extends Cache&gt; typeClass, Class&lt;? extends Cache&gt; evictionClass, Long flushInterval, Integer size, <span class="keyword">boolean</span> readWrite, <span class="keyword">boolean</span> blocking, Properties props)</span> </span>&#123;</span><br><span class="line">        Cache cache = (<span class="keyword">new</span> CacheBuilder(<span class="keyword">this</span>.currentNamespace)).implementation((Class)<span class="keyword">this</span>.valueOrDefault(typeClass, PerpetualCache.class)).addDecorator((Class)<span class="keyword">this</span>.valueOrDefault(evictionClass, LruCache.class)).clearInterval(flushInterval).size(size).readWrite(readWrite).blocking(blocking).properties(props).build(); <span class="comment">// build cache </span></span><br><span class="line">        <span class="keyword">this</span>.configuration.addCache(cache);</span><br><span class="line">        <span class="keyword">this</span>.currentCache = cache;</span><br><span class="line">        <span class="keyword">return</span> cache;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CacheBuilder</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CacheBuilder</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.decorators = <span class="keyword">new</span> ArrayList();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CacheBuilder <span class="title">implementation</span><span class="params">(Class&lt;? extends Cache&gt; implementation)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.implementation = implementation;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">public</span> Cache <span class="title">build</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setDefaultImplementations();</span><br><span class="line">        Cache cache = <span class="keyword">this</span>.newBaseCacheInstance(<span class="keyword">this</span>.implementation, <span class="keyword">this</span>.id);</span><br><span class="line">        <span class="keyword">this</span>.setCacheProperties((Cache)cache);</span><br><span class="line">        <span class="keyword">if</span> (PerpetualCache.class.equals(cache.getClass())) &#123;</span><br><span class="line">            Iterator var2 = <span class="keyword">this</span>.decorators.iterator();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span>(var2.hasNext()) &#123;</span><br><span class="line">                Class&lt;? extends Cache&gt; decorator = (Class)var2.next();</span><br><span class="line">                cache = <span class="keyword">this</span>.newCacheDecoratorInstance(decorator, (Cache)cache);</span><br><span class="line">                <span class="keyword">this</span>.setCacheProperties((Cache)cache);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            cache = <span class="keyword">this</span>.setStandardDecorators((Cache)cache);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!LoggingCache.class.isAssignableFrom(cache.getClass())) &#123;</span><br><span class="line">            cache = <span class="keyword">new</span> LoggingCache((Cache)cache);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (Cache)cache;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">private</span> Cache <span class="title">setStandardDecorators</span><span class="params">(Cache cache)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            MetaObject metaCache = SystemMetaObject.forObject(cache);</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.size != <span class="keyword">null</span> &amp;&amp; metaCache.hasSetter(<span class="string">&quot;size&quot;</span>)) &#123;</span><br><span class="line">                metaCache.setValue(<span class="string">&quot;size&quot;</span>, <span class="keyword">this</span>.size);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.clearInterval != <span class="keyword">null</span>) &#123;</span><br><span class="line">                cache = <span class="keyword">new</span> ScheduledCache((Cache)cache);</span><br><span class="line">                ((ScheduledCache)cache).setClearInterval(<span class="keyword">this</span>.clearInterval);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.readWrite) &#123;</span><br><span class="line">                cache = <span class="keyword">new</span> SerializedCache((Cache)cache);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            Cache cache = <span class="keyword">new</span> LoggingCache((Cache)cache);</span><br><span class="line">            cache = <span class="keyword">new</span> SynchronizedCache(cache);</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.blocking) &#123;</span><br><span class="line">                cache = <span class="keyword">new</span> BlockingCache((Cache)cache);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> (Cache)cache;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception var3) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> CacheException(<span class="string">&quot;Error building standard cache decorators.  Cause: &quot;</span> + var3, var3);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»è€Œè¨€ä¹‹ï¼Œmybatisä¸­cacheç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/2021/05/20/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/cache1.png" alt="cache1"></p><p>Cacheæœ‰å¾ˆå¤šå®ç°ç±»ï¼Œæ¯ä¸ªå®ç°ç±»éƒ½æœ‰ä¸åŒçš„åŠŸèƒ½ï¼Œå¹¶ä¸”ä½¿ç”¨deletateå±æ€§ï¼Œä½¿å¼•ç”¨æŒ‡å‘ä¸‹ä¸€ä¸ªå®ç°ç±»ä»è€Œè¡Œæˆä¸€æ¡å¼•ç”¨é“¾æ¡ï¼Œæœ€ç»ˆå­˜å‚¨æ•°æ®çš„å…¶å®æ˜¯PerpetualCacheä¸­çš„map.</p><h4 id="é—®é¢˜ä¸€ï¼š"><a href="#é—®é¢˜ä¸€ï¼š" class="headerlink" title="é—®é¢˜ä¸€ï¼š"></a>é—®é¢˜ä¸€ï¼š</h4><p>â€‹    æˆ‘ä»¬å¹³å¸¸æ‰€çœ‹åˆ°çš„Filterã€Interceptorã€pipelineè¿™äº›éƒ½å±äºè´£ä»»é“¾æ¨¡å¼å—ï¼Ÿå¦‚æœæ˜¯è¯·è¯´å‡ºä½ åœ¨å“ªäº›æ¡†æ¶æºç ä¸­æœ‰è§è¿‡è¿™äº›åœºæ™¯?ä»–ä»¬å±äºç»å…¸è´£ä»»é“¾æ¨¡å¼ï¼Œè¿˜æ˜¯å˜ç§è´£ä»»é“¾ï¼Ÿ</p><h4 id="é—®é¢˜äºŒï¼š"><a href="#é—®é¢˜äºŒï¼š" class="headerlink" title="é—®é¢˜äºŒï¼š"></a>é—®é¢˜äºŒï¼š</h4><p>â€‹    åŸºäºä»¥ä¸‹åœºæ™¯è®¾è®¡ä¸€ä¸ªç»å…¸è´£ä»»é“¾æ¨¡å¼ã€‚</p><p>â€‹    è¯·å‡å®¡æ‰¹æµç¨‹ï¼š1å¤©ä»¥å†…ç”±HRç›´æ¥å®¡æ‰¹ï¼Œ2åˆ°3å¤©ç”±éƒ¨é—¨ä¸»ç®¡å®¡æ‰¹ï¼Œä¸‰å¤©ä»¥ä¸Šç”±ç»ç†è¿›è¡Œå®¡æ‰¹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Approve</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String HR = <span class="string">&quot;hr&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEPARTMENT = <span class="string">&quot;department&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MANAGER = <span class="string">&quot;manager&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å½“å‰å®¡æ‰¹äººå®¡æ‰¹æœ€å¤§å¤©æ•°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> maxDay;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è´£ä»»é“¾ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">    <span class="keyword">protected</span> Approve nextApprove;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Approve</span><span class="params">(<span class="keyword">int</span> maxDay)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.maxDay = maxDay;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®¡æ‰¹</span></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">approve</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">approveDays</span><span class="params">(<span class="keyword">int</span> day)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (day &lt;= maxDay) &#123;</span><br><span class="line">            approve();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (nextApprove != <span class="keyword">null</span>) &#123;</span><br><span class="line">                nextApprove.approveDays(day);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;mmp,æ²¡äººæ‰¹ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNextApprove</span><span class="params">(Approve nextApprove)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.nextApprove = nextApprove;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HRApprove</span> <span class="keyword">extends</span> <span class="title">Approve</span> </span>&#123;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="title">HRApprove</span><span class="params">(<span class="keyword">int</span> maxDay)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(maxDay);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">approve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(HRApprove.HR + <span class="string">&quot;å®¡æ‰¹&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DepartmentApprove</span> <span class="keyword">extends</span> <span class="title">Approve</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">DepartmentApprove</span><span class="params">(<span class="keyword">int</span> maxDay)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(maxDay);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">approve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(HRApprove.DEPARTMENT + <span class="string">&quot;å®¡æ‰¹&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ManagerApprove</span> <span class="keyword">extends</span> <span class="title">Approve</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ManagerApprove</span><span class="params">(<span class="keyword">int</span> maxDay)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(maxDay);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">approve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(HRApprove.MANAGER + <span class="string">&quot;å®¡æ‰¹&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">int</span> day = <span class="number">22</span>;</span><br><span class="line">      Approve hrApprove = <span class="keyword">new</span> HRApprove(<span class="number">1</span>);</span><br><span class="line">      Approve departmentApprove = <span class="keyword">new</span> DepartmentApprove(<span class="number">3</span>);</span><br><span class="line">      Approve managerApprove = <span class="keyword">new</span> ManagerApprove(<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// è®¾ç½®ä¸Šçº§å¼•ç”¨</span></span><br><span class="line">      hrApprove.setNextApprove(departmentApprove);</span><br><span class="line">      departmentApprove.setNextApprove(managerApprove);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// å®¡æ‰¹</span></span><br><span class="line">      hrApprove.approveDays(day);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä¼—å¤šä¼˜ç§€çš„å¼€æºæ¡†æ¶ä¸­ï¼Œå…¶æºç å¤§é‡ä½¿ç”¨äº†è®¾è®¡æ¨¡å¼ï¼Œå…¶ä¸­è´£ä»»é“¾æ¨¡å¼æ˜¯æ¯”è¾ƒé‡è¦å¹¶ä¸”è¢«å¹¿æ³›ä½¿ç”¨çš„ï¼Œå¦‚æœå¯¹è®¾è®¡æ¨¡å¼ä¸æ¸…æ¥šï¼Œåœ¨é˜…è¯»æºç çš„è¿‡ç¨‹ä¸­å°±å¾ˆå®¹æ˜“è¿·å¤±æ–¹å‘ã€‚&lt;/p&gt;
&lt;h4 id=&quot;åŸç†&quot;&gt;&lt;a href=&quot;#åŸç†&quot; class=&quot;headerlink&quot; title=&quot;åŸç†&quot;&gt;&lt;/</summary>
      
    
    
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="http://example.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
  </entry>
  
  <entry>
    <title>éšç¬”</title>
    <link href="http://example.com/2021/05/18/%E9%9A%8F%E7%AC%94/"/>
    <id>http://example.com/2021/05/18/%E9%9A%8F%E7%AC%94/</id>
    <published>2021-05-18T11:41:17.000Z</published>
    <updated>2021-05-19T12:00:53.931Z</updated>
    
    <content type="html"><![CDATA[<h4 id="åŒ…æƒé™"><a href="#åŒ…æƒé™" class="headerlink" title="åŒ…æƒé™"></a>åŒ…æƒé™</h4><p>protectedï¼šåŒä¸€ä¸ªåŒ…ä¸‹åŠå…¶å­ç±»</p><h4 id="æºç é˜…è¯»ç½‘"><a href="#æºç é˜…è¯»ç½‘" class="headerlink" title="æºç é˜…è¯»ç½‘"></a>æºç é˜…è¯»ç½‘</h4><p> <a href="http://coderead.cn/">http://coderead.cn</a></p><h4 id="çƒ­ç‚¹æ¥å£ç¼“å­˜æ–¹æ¡ˆ"><a href="#çƒ­ç‚¹æ¥å£ç¼“å­˜æ–¹æ¡ˆ" class="headerlink" title="çƒ­ç‚¹æ¥å£ç¼“å­˜æ–¹æ¡ˆ"></a>çƒ­ç‚¹æ¥å£ç¼“å­˜æ–¹æ¡ˆ</h4><blockquote><p>è‡ªå·±çš„é¡¹ç›®é‡Œï¼Œé«˜é¢‘æ¥å£å¢åŠ æœ¬åœ°ç¼“å­˜æ–¹æ¡ˆï¼Œå¯ä»¥é€‰æ‹©ç”¨è£…é¥°è€…æ¨¡å¼ï¼Œæ–°å®šä¹‰ä¸€ä¸ªLocalCacheUtilï¼ŒæŠŠredisUtilä½œä¸ºä»£ç†æ”¾è¿›å»ã€‚å…ˆæŸ¥localCacheï¼Œæœ‰ç›´æ¥è¿”å›ï¼Œæ²¡æœ‰æŸ¥redisï¼Œå†æŠŠredisæŸ¥è¯¢ç»“æœæ”¾åˆ°localCacheã€‚å¤šå°æœºå™¨æœ¬åœ°ç¼“å­˜å¤±æ•ˆæ–¹å¼ï¼šé€šè¿‡redis pub/sub é€šçŸ¥åˆ°å„ä¸ªæœºå™¨ä¸»åŠ¨å¤±æ•ˆæ‰ï¼</p></blockquote><h4 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾"></a>æšä¸¾</h4><h5 id="é—®é¢˜ï¼š"><a href="#é—®é¢˜ï¼š" class="headerlink" title="é—®é¢˜ï¼š"></a>é—®é¢˜ï¼š</h5><blockquote><ol><li><p>æšä¸¾å…è®¸ç»§æ‰¿ç±»å—ï¼Ÿ</p><p>æšä¸¾ä¸å…è®¸ç»§æ‰¿ç±»ã€‚Jvmåœ¨ç”Ÿæˆæšä¸¾æ—¶å·²ç»ç»§æ‰¿äº†Enumç±»ï¼Œç”±äºJavaè¯­è¨€æ˜¯å•ç»§æ‰¿ï¼Œä¸æ”¯æŒå†ç»§æ‰¿é¢å¤–çš„ç±»</p></li><li><p>æšä¸¾å…è®¸å®ç°æ¥å£å—ï¼Ÿ</p><p>æšä¸¾å…è®¸å®ç°æ¥å£ã€‚å› ä¸ºæšä¸¾æœ¬èº«å°±æ˜¯ä¸€ä¸ªç±»ï¼Œç±»æ˜¯å¯ä»¥å®ç°å¤šä¸ªæ¥å£çš„ã€‚</p></li><li><p>æšä¸¾å¯ä»¥ç”¨ç­‰å·æ¯”è¾ƒå—ï¼Ÿ</p><p>æšä¸¾å¯ä»¥ç”¨ç­‰å·æ¯”è¾ƒã€‚Jvmä¼šä¸ºæ¯ä¸ªæšä¸¾å®ä¾‹å¯¹åº”ç”Ÿæˆä¸€ä¸ªç±»å¯¹è±¡ï¼Œè¿™ä¸ªç±»å¯¹è±¡æ˜¯ç”¨public static finalä¿®é¥°çš„ï¼Œåœ¨staticä»£ç å—ä¸­åˆå§‹åŒ–ï¼Œæ˜¯ä¸€ä¸ªå•ä¾‹</p></li><li><p>å¯ä»¥ç»§æ‰¿æšä¸¾å—ï¼Ÿ</p><p>ä¸å¯ä»¥ç»§æ‰¿æšä¸¾ã€‚å› ä¸ºJvmåœ¨ç”Ÿæˆæšä¸¾ç±»æ—¶ï¼Œå°†å®ƒå£°æ˜ä¸ºfinalã€‚</p></li><li><p>æšä¸¾å¯ä»¥å®ç°å•ä¾‹æ¨¡å¼å—ï¼Ÿ</p><p>æšä¸¾æœ¬èº«å°±æ˜¯ä¸€ç§å¯¹å•ä¾‹è®¾è®¡æ¨¡å¼å‹å¥½çš„å½¢å¼ï¼Œå®ƒæ˜¯å®ç°å•ä¾‹æ¨¡å¼çš„ä¸€ç§å¾ˆå¥½çš„æ–¹å¼ã€‚</p></li><li><p>å½“ä½¿ç”¨compareTo()æ¯”è¾ƒæšä¸¾æ—¶ï¼Œæ¯”è¾ƒçš„æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>æšä¸¾ç±»å‹çš„compareTo()æ–¹æ³•æ¯”è¾ƒçš„æ˜¯æšä¸¾ç±»å¯¹è±¡çš„ordinalçš„å€¼ã€‚</p></li><li><p>å½“ä½¿ç”¨equals()æ¯”è¾ƒæšä¸¾çš„æ—¶å€™ï¼Œæ¯”è¾ƒçš„æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>æšä¸¾ç±»å‹çš„equals()æ–¹æ³•æ¯”è¾ƒçš„æ˜¯æšä¸¾ç±»å¯¹è±¡çš„å†…å­˜åœ°å€ï¼Œä½œç”¨ä¸ç­‰å·ç­‰ä»·ã€‚</p></li></ol></blockquote><h5 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">Fruit</span></span>&#123;</span><br><span class="line">    APPLE(<span class="number">1</span>),ORANGE(<span class="number">2</span>),BANANA(<span class="number">3</span>);</span><br><span class="line">    <span class="keyword">int</span> code;</span><br><span class="line"></span><br><span class="line">    Fruit(<span class="keyword">int</span> code)&#123;</span><br><span class="line">        <span class="keyword">this</span>.code=code;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨Jadå‘½ä»¤åç¼–è¯‘Fruit.classæ–‡ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Fruit</span> <span class="keyword">extends</span> <span class="title">Enum</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Fruit[] values()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> (Fruit[])$VALUES.clone();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Fruit <span class="title">valueOf</span><span class="params">(String s)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (Fruit)Enum.valueOf(Fruit, s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Fruit</span><span class="params">(String s, <span class="keyword">int</span> i, <span class="keyword">int</span> j)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(s, i);</span><br><span class="line">        code = j;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Fruit APPLE;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Fruit ORANGE;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Fruit BANANA;</span><br><span class="line">    <span class="keyword">int</span> code;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Fruit $VALUES[];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span></span><br><span class="line">    &#123;</span><br><span class="line">        APPLE = <span class="keyword">new</span> Fruit(<span class="string">&quot;APPLE&quot;</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">        ORANGE = <span class="keyword">new</span> Fruit(<span class="string">&quot;ORANGE&quot;</span>, <span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">        BANANA = <span class="keyword">new</span> Fruit(<span class="string">&quot;BANANA&quot;</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">        $VALUES = (<span class="keyword">new</span> Fruit[] &#123;</span><br><span class="line">            APPLE, ORANGE, BANANA</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º:"></a>ç»“è®º:</h5><p>jvmåšäº†ä»¥ä¸‹äº‹æƒ…</p><blockquote><ul><li><em>æšä¸¾ç±»æ˜¯ç”¨finalä¿®é¥°çš„ï¼Œå¹¶ä¸”é»˜è®¤ç»§æ‰¿Enumç±»</em></li><li><em>ä¸ºæ¯ä¸ªæšä¸¾å®ä¾‹å¯¹åº”åˆ›å»ºä¸€ä¸ªç±»å¯¹è±¡ï¼Œè¿™äº›ç±»å¯¹è±¡æ˜¯ç”¨public static finalä¿®é¥°çš„ã€‚åŒæ—¶ç”Ÿæˆä¸€ä¸ªæ•°ç»„ï¼Œç”¨äºä¿å­˜å…¨éƒ¨çš„ç±»å¯¹è±¡</em></li><li><em>ç”Ÿæˆä¸€ä¸ªé™æ€ä»£ç å—ï¼Œç”¨äºåˆå§‹åŒ–ç±»å¯¹è±¡å’Œç±»å¯¹è±¡æ•°ç»„</em></li><li><em>ç”Ÿæˆä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œæ„é€ å‡½æ•°åŒ…å«è‡ªå®šä¹‰å‚æ•°å’Œä¸¤ä¸ªé»˜è®¤å‚æ•°</em></li><li><em>ç”Ÿæˆä¸€ä¸ªé™æ€çš„values()æ–¹æ³•ï¼Œç”¨äºè¿”å›æ‰€æœ‰çš„ç±»å¯¹è±¡</em></li><li><em>ç”Ÿæˆä¸€ä¸ªé™æ€çš„valueOf()æ–¹æ³•ï¼Œæ ¹æ®nameå‚æ•°è¿”å›å¯¹åº”çš„ç±»å®ä¾‹</em></li></ul></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;åŒ…æƒé™&quot;&gt;&lt;a href=&quot;#åŒ…æƒé™&quot; class=&quot;headerlink&quot; title=&quot;åŒ…æƒé™&quot;&gt;&lt;/a&gt;åŒ…æƒé™&lt;/h4&gt;&lt;p&gt;protectedï¼šåŒä¸€ä¸ªåŒ…ä¸‹åŠå…¶å­ç±»&lt;/p&gt;
&lt;h4 id=&quot;æºç é˜…è¯»ç½‘&quot;&gt;&lt;a href=&quot;#æºç é˜…è¯»ç½‘&quot; class=&quot;hea</summary>
      
    
    
    
    <category term="éšç¬”" scheme="http://example.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
  </entry>
  
  <entry>
    <title>å¾®æœåŠ¡è·å–ç½‘å…³</title>
    <link href="http://example.com/2021/05/18/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E8%8E%B7%E5%8F%96%E7%BD%91%E5%85%B3/"/>
    <id>http://example.com/2021/05/18/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E8%8E%B7%E5%8F%96%E7%BD%91%E5%85%B3/</id>
    <published>2021-05-18T09:50:07.000Z</published>
    <updated>2021-05-18T09:51:52.695Z</updated>
    
    <content type="html"><![CDATA[<p>ä»ç½‘å…³è·å–å®¢æˆ·ç«¯çœŸå®ip</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClientIpFilter</span> <span class="keyword">extends</span> <span class="title">ZuulFilter</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String I_REMOTE_ADDR = <span class="string">&quot;I_REMOTE_ADDR&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">run</span><span class="params">()</span> <span class="keyword">throws</span> ZuulException </span>&#123;</span><br><span class="line">        RequestContext ctx = RequestContext.getCurrentContext();</span><br><span class="line">        HttpServletRequest request = ctx.getRequest();</span><br><span class="line">        String remoteAddr = request.getRemoteAddr();</span><br><span class="line">        ctx.getZuulRequestHeaders().put(I_REMOTE_ADDR, remoteAddr);</span><br><span class="line">        <span class="keyword">return</span> ctx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * preï¼šå¯ä»¥åœ¨è¯·æ±‚è¢«è·¯ç”±ä¹‹å‰è°ƒç”¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">filterType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;pre&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">filterOrder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦æ‰§è¡Œè¯¥è¿‡æ»¤å™¨ï¼Œtrueï¼Œè¯´æ˜éœ€è¦è¿‡æ»¤</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">shouldFilter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä»ç½‘å…³è·å–å®¢æˆ·ç«¯çœŸå®ip&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/s</summary>
      
    
    
    
    <category term="éšç¬”" scheme="http://example.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
  </entry>
  
  <entry>
    <title>åå°„</title>
    <link href="http://example.com/2021/05/17/%E5%8F%8D%E5%B0%84/"/>
    <id>http://example.com/2021/05/17/%E5%8F%8D%E5%B0%84/</id>
    <published>2021-05-17T03:23:46.000Z</published>
    <updated>2021-05-19T08:08:09.091Z</updated>
    
    <content type="html"><![CDATA[<p>å‚è€ƒæ–‡ç« ï¼š <a href="https://zhuanlan.zhihu.com/p/80519709">https://zhuanlan.zhihu.com/p/80519709</a></p><h4 id="åŠŸèƒ½"><a href="#åŠŸèƒ½" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h4><p>é€šè¿‡ Javaåå°„ï¼Œèƒ½å¤Ÿåœ¨ç±»çš„è¿è¡Œè¿‡ç¨‹ä¸­çŸ¥é“è¿™ä¸ªç±»æœ‰å“ªäº›å±æ€§å’Œæ–¹æ³•ï¼Œè¿˜å¯ä»¥ä¿®æ”¹å±æ€§ã€è°ƒç”¨æ–¹æ³•ã€å»ºç«‹ç±»çš„å®ä¾‹ã€‚</p><blockquote><p> åœ¨è¿è¡Œæ—¶åˆ¤æ–­ä»»æ„ä¸€ä¸ªå¯¹è±¡æ‰€å±çš„ç±»ï¼›</p><p> åœ¨è¿è¡Œæ—¶æ„é€ ä»»æ„ä¸€ä¸ªç±»çš„å¯¹è±¡ï¼›</p><p> åœ¨è¿è¡Œæ—¶ä¿®æ”¹ä»»æ„ä¸€ä¸ªå¯¹è±¡çš„æˆå‘˜å˜é‡ï¼›</p><p> åœ¨è¿è¡Œæ—¶è°ƒç”¨ä»»æ„ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ã€‚</p></blockquote><h4 id="Classå¯¹è±¡"><a href="#Classå¯¹è±¡" class="headerlink" title="Classå¯¹è±¡"></a><strong>Classå¯¹è±¡</strong></h4><p>æ£€æŸ¥ä¸€ä¸ªç±»ä¹‹å‰ï¼Œå¿…é¡»è·å–åˆ°java.lang.Classå¯¹è±¡ï¼Œjavaä¸­çš„æ‰€æœ‰ç±»å‹ï¼ŒåŒ…æ‹¬longï¼Œintï¼Œæ•°ç»„ç­‰åŸºæœ¬æ•°æ®ç±»å‹ï¼Œéƒ½å’ŒClasså¯¹è±¡æœ‰å…³ç³»ã€‚</p><p>æˆ‘ä»¬å¾ˆå¤šäººå»åŒ»é™¢å‚åŠ ä½“æ£€çš„æ—¶å€™ï¼Œéƒ½åšè¿‡Bè¶…æ£€æŸ¥ï¼ŒåŒ»ç”Ÿåªéœ€æŠŠä¸€ä¸ªæ¢å¤´åœ¨æˆ‘ä»¬èº«ä¸Šæ»‘åŠ¨å°±å¯ä»¥å°†æˆ‘ä»¬ä½“å†…çš„è‚ã€èƒ†ã€è‚¾ç­‰å™¨å®˜åå°„åˆ°Bè¶…è®¾å¤‡ä¸Šæ˜¾ç¤ºã€‚</p><p>Classç±»å¯¹è±¡å°±ç›¸å½“äºBè¶…çš„æ¢å¤´ï¼Œå°†ä¸€ä¸ªç±»çš„æ–¹æ³•ã€å˜é‡ã€æ¥å£ã€ç±»åã€ç±»ä¿®é¥°ç¬¦ç­‰ä¿¡æ¯å‘Šè¯‰è¿è¡Œçš„ç¨‹åºã€‚</p><p>Javaæä¾›äº†ä¸¤ç§æ–¹å¼è·å–Classå¯¹è±¡ï¼Œä¸€ç§æ˜¯ä½¿ç”¨.classï¼Œå¦å¤–ä¸€ç§æ˜¯ä½¿ç”¨Class.forName()ã€‚.classæ–¹å¼é€‚ç”¨äºåœ¨ç¼–è¯‘æ—¶å·²ç»çŸ¥é“å…·ä½“çš„ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class alunbarClass = Alunbar.class;</span><br></pre></td></tr></table></figure><p>Class.forName()æ–¹å¼é€‚ç”¨äºè¿è¡Œæ—¶<strong>åŠ¨æ€è·å–</strong>Classå¯¹è±¡ï¼Œåªéœ€å°†ç±»åä½œä¸ºforNameæ–¹æ³•çš„å‚æ•°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    Class alunbarClass1 = Class.forName(<span class="string">&quot;Alunbar&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(ClassNotFoundException e)&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ‰¾ä¸åˆ°Alunbarç±»&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¿™ä¸ªæ–¹æ³•ä¼šå‡ºç°ç±»æ‰¾ä¸åˆ°çš„æƒ…å†µï¼Œå› æ­¤ä½¿ç”¨è¿™ä¸ªæ–¹æ³•è·å–Classå¯¹è±¡æ—¶ï¼Œå¿…é¡»æ•è·ClassNotFoundExceptionå¼‚å¸¸ã€‚</p></blockquote><h5 id="è·å–ç±»å"><a href="#è·å–ç±»å" class="headerlink" title="è·å–ç±»å"></a><strong>è·å–ç±»å</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.alunbar;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Alunbar</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span>  <span class="title">main</span><span class="params">(String arts[])</span></span>&#123;</span><br><span class="line">        Class alunbarClass = Alunbar.class;</span><br><span class="line">        System.out.println(alunbarClass.getName());</span><br><span class="line">        System.out.println(alunbarClass.getSimpleName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿è¡Œç»“æœ:</span></span><br><span class="line"><span class="comment">// cn.alunbar.Alunbar</span></span><br><span class="line"><span class="comment">// Alunbar</span></span><br></pre></td></tr></table></figure><blockquote><p>getName()æ–¹æ³•è·å–çš„ç±»ååŒ…å«åŒ…ä¿¡æ¯ã€‚getSimpleName()æ–¹æ³•åªæ˜¯è·å–ç±»åï¼Œä¸åŒ…å«åŒ…ä¿¡æ¯ã€‚</p></blockquote><h5 id="è·å–ç±»ä¿®é¥°ç¬¦"><a href="#è·å–ç±»ä¿®é¥°ç¬¦" class="headerlink" title="è·å–ç±»ä¿®é¥°ç¬¦"></a><strong>è·å–ç±»ä¿®é¥°ç¬¦</strong></h5>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å‚è€ƒæ–‡ç« ï¼š &lt;a href=&quot;https://zhuanlan.zhihu.com/p/80519709&quot;&gt;https://zhuanlan.zhihu.com/p/80519709&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;åŠŸèƒ½&quot;&gt;&lt;a href=&quot;#åŠŸèƒ½&quot; class=&quot;head</summary>
      
    
    
    
    <category term="javaåŸºç¡€" scheme="http://example.com/categories/java%E5%9F%BA%E7%A1%80/"/>
    
    
  </entry>
  
  <entry>
    <title>è£…é¥°å™¨æ¨¡å¼</title>
    <link href="http://example.com/2021/05/17/%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
    <id>http://example.com/2021/05/17/%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F/</id>
    <published>2021-05-17T03:23:30.000Z</published>
    <updated>2021-05-19T11:25:27.900Z</updated>
    
    <content type="html"><![CDATA[<h4 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><blockquote><p>è£…é¥°å™¨æ¨¡å¼åˆç§°åŒ…è£…æ¨¡å¼ï¼Œæ˜¯ä¸€ç§ç»“æ„å‹æ¨¡å¼ã€‚</p><p>è¿™ç§è®¾è®¡æ¨¡å¼æ˜¯æŒ‡èƒ½å¤Ÿåœ¨ä¸€ä¸ªç±»çš„åŸºç¡€ä¸Šå¢åŠ ä¸€ä¸ªè£…é¥°ç±»ï¼ˆä¹Ÿå¯ä»¥å«åŒ…è£…ç±»ï¼‰ï¼Œå¹¶åœ¨è£…é¥°ç±»ä¸­å¢åŠ ä¸€äº›æ–°çš„ç‰¹æ€§å’ŒåŠŸèƒ½ã€‚</p><p>è¿™æ ·ï¼Œé€šè¿‡å¯¹åŸæœ‰ç±»çš„åŒ…è£…ï¼Œå°±å¯ä»¥åœ¨ä¸æ”¹å˜åŸæœ‰ç±»çš„æƒ…å†µä¸‹ä¸ºåŸæœ‰ç±»å¢åŠ æ›´å¤šçš„åŠŸèƒ½ã€‚</p></blockquote><h4 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><p>å®šä¹‰phoneæ¥å£ï¼Œå®ƒè§„å®šäº†å‘é€å’Œæ¥æ”¶è¯­éŸ³çš„æŠ½è±¡æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Phone</span> </span>&#123;</span><br><span class="line">    <span class="function">String <span class="title">callIn</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">Boolean <span class="title">callOut</span><span class="params">(String info)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2.ç„¶åå®šä¹‰ä¸€ä¸ªç±» TelePhoneï¼Œå®ç° Phone æ¥å£ï¼Œèƒ½å¤Ÿå®ç°æ‰“ç”µè¯çš„åŠŸèƒ½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TelePhone</span> <span class="keyword">implements</span> <span class="title">Phone</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">callIn</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ¥æ”¶è¯­éŸ³ã€‚ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;get info&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">callOut</span><span class="params">(String info)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å‘é€è¯­éŸ³ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.ç°åœ¨è¦åˆ›å»ºä¸€ä¸ªè£…é¥°ç±»ï¼Œåœ¨ä¸æ”¹å˜åŸæœ‰ TelePhone çš„åŸºç¡€ä¸Šï¼Œå®ç°é€šè¯å½•éŸ³åŠŸèƒ½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PhoneRecordDecorator</span> <span class="keyword">implements</span> <span class="title">Phone</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Phone decoratedPhone;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PhoneRecordDecorator</span><span class="params">(Phone decoratedPhone)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.decoratedPhone = decoratedPhone;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">callIn</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å¯åŠ¨å½•éŸ³ã€‚ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">        String info = decoratedPhone.callIn();</span><br><span class="line">        <span class="keyword">return</span> info;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">callOut</span><span class="params">(String info)</span> </span>&#123;</span><br><span class="line">        decoratedPhone.callOut(info);</span><br><span class="line">        System.out.println(<span class="string">&quot;ç»“æŸå½•éŸ³ã€‚ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œç»è¿‡ PhoneRecordDecoratoråŒ…è£…è¿‡çš„ Phoneå°±å…·æœ‰äº†é€šè¯å½•éŸ³åŠŸèƒ½.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åŸæœ‰phoneæ— å½•éŸ³åŠŸèƒ½&quot;</span>);</span><br><span class="line">        TelePhone telePhone = <span class="keyword">new</span> TelePhone();</span><br><span class="line">        telePhone.callIn();</span><br><span class="line">        telePhone.callOut(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;---------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;ç»è¿‡è£…é¥°åçš„phoneæœ‰å½•éŸ³åŠŸèƒ½&quot;</span>);</span><br><span class="line">        PhoneRecordDecorator prd = <span class="keyword">new</span> PhoneRecordDecorator(telePhone);</span><br><span class="line">        prd.callIn();</span><br><span class="line">        prd.callOut(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿è¡Œç»“æœ ï¼š</span></span><br><span class="line"><span class="comment">/*åŸæœ‰phoneæ— å½•éŸ³åŠŸèƒ½</span></span><br><span class="line"><span class="comment">æ¥æ”¶è¯­éŸ³ã€‚ã€‚ã€‚</span></span><br><span class="line"><span class="comment">å‘é€è¯­éŸ³ã€‚ã€‚ã€‚</span></span><br><span class="line"><span class="comment">---------------</span></span><br><span class="line"><span class="comment">ç»è¿‡è£…é¥°åçš„phoneæœ‰å½•éŸ³åŠŸèƒ½</span></span><br><span class="line"><span class="comment">å¯åŠ¨å½•éŸ³ã€‚ã€‚ã€‚ã€‚</span></span><br><span class="line"><span class="comment">æ¥æ”¶è¯­éŸ³ã€‚ã€‚ã€‚</span></span><br><span class="line"><span class="comment">å‘é€è¯­éŸ³ã€‚ã€‚ã€‚</span></span><br><span class="line"><span class="comment">ç»“æŸå½•éŸ³ã€‚ã€‚ã€‚ã€‚*/</span></span><br></pre></td></tr></table></figure><blockquote><p>éµç…§è¿™ä¸ªæ€æƒ³ï¼Œè¿˜å¯ä»¥é€šè¿‡è£…é¥°ç±»å¢åŠ æ–°çš„æ–¹æ³•ã€å±æ€§ç­‰ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ç»™åŸæ¥çš„ TelePhoneç±»å¢åŠ æ”¶å‘çŸ­ä¿¡åŠŸèƒ½ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PhoneMessageDecorator</span> <span class="keyword">implements</span> <span class="title">Phone</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Phone decoratedPhone;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PhoneMessageDecorator</span><span class="params">(Phone decoratedPhone)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.decoratedPhone = decoratedPhone;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">callIn</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> decoratedPhone.callIn();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">callOut</span><span class="params">(String info)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> decoratedPhone.callOut(info);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">receiveMessage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// çœç•¥æ¥å—çŸ­ä¿¡æ“ä½œ</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;receive message&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">sendMessage</span><span class="params">(String msg)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// çœç•¥å‘é€çŸ­ä¿¡æ“ä½œ</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è£…é¥°å™¨æ¨¡å¼åœ¨ç¼–ç¨‹å¼€å‘ä¸­ç»å¸¸ä½¿ç”¨ã€‚é€šå¸¸çš„ä½¿ç”¨åœºæ™¯æ˜¯åœ¨ä¸€ä¸ªæ ¸å¿ƒåŸºæœ¬ç±»çš„åŸºç¡€ä¸Šï¼Œæä¾›å¤§é‡çš„è£…é¥°ç±»ï¼Œä»è€Œä½¿æ ¸å¿ƒåŸºæœ¬ç±»ç»è¿‡ä¸åŒçš„è£…é¥°ç±»ä¿®é¥°åè·å¾—ä¸åŒçš„åŠŸèƒ½ã€‚</p><p>è£…é¥°ç±»è¿˜æœ‰ä¸€ä¸ªä¼˜ç‚¹ï¼Œå°±æ˜¯å¯ä»¥å åŠ ä½¿ç”¨ï¼Œå³ä¸€ä¸ªæ ¸å¿ƒåŸºæœ¬ç±»å¯ä»¥è¢«å¤šä¸ªè£…é¥°ç±»ä¿®é¥°ï¼Œä»è€ŒåŒæ—¶å…·æœ‰å¤šä¸ªè£…é¥°ç±»çš„åŠŸèƒ½ã€‚</p></blockquote><h4 id="mybatisç¤ºä¾‹"><a href="#mybatisç¤ºä¾‹" class="headerlink" title="mybatisç¤ºä¾‹"></a>mybatisç¤ºä¾‹</h4><p>mybatisæºç ä¸­æ‰§è¡Œå™¨æ¨¡å—ä¹Ÿä½¿ç”¨äº†è£…é¥°å™¨æ¨¡å¼ã€‚</p><h5 id="executorç»“æ„"><a href="#executorç»“æ„" class="headerlink" title="executorç»“æ„"></a>executorç»“æ„</h5><p><img src="/2021/05/17/%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F/mybatis%E6%B5%81%E7%A8%8B.png" alt="mybatisæ‰§è¡Œè¿‡ç¨‹"></p><p>ç®€å•ä»‹ç»ä¸€ä¸‹ä¸Šå›¾ä¸­è¿™äº›ç±»ä¹‹é—´çš„é€»è¾‘å…³ç³»ï¼Œä»¥åŠæ‰§è¡Œæµç¨‹</p><ol><li>é¦–å…ˆSqlSession</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SqlSession</span> <span class="keyword">extends</span> <span class="title">Closeable</span> </span>&#123;</span><br><span class="line">    &lt;T&gt; <span class="function">T <span class="title">selectOne</span><span class="params">(String var1)</span></span>;</span><br><span class="line"></span><br><span class="line">    &lt;T&gt; <span class="function">T <span class="title">selectOne</span><span class="params">(String var1, Object var2)</span></span>;</span><br><span class="line"></span><br><span class="line">    &lt;E&gt; <span class="function">List&lt;E&gt; <span class="title">selectList</span><span class="params">(String var1)</span></span>;</span><br><span class="line"></span><br><span class="line">    &lt;E&gt; <span class="function">List&lt;E&gt; <span class="title">selectList</span><span class="params">(String var1, Object var2)</span></span>;</span><br><span class="line"></span><br><span class="line">    &lt;E&gt; <span class="function">List&lt;E&gt; <span class="title">selectList</span><span class="params">(String var1, Object var2, RowBounds var3)</span></span>;</span><br><span class="line"></span><br><span class="line">    &lt;K, V&gt; <span class="function">Map&lt;K, V&gt; <span class="title">selectMap</span><span class="params">(String var1, String var2)</span></span>;</span><br><span class="line"></span><br><span class="line">    &lt;K, V&gt; <span class="function">Map&lt;K, V&gt; <span class="title">selectMap</span><span class="params">(String var1, Object var2, String var3)</span></span>;</span><br><span class="line"></span><br><span class="line">    &lt;K, V&gt; <span class="function">Map&lt;K, V&gt; <span class="title">selectMap</span><span class="params">(String var1, Object var2, String var3, RowBounds var4)</span></span>;</span><br><span class="line"></span><br><span class="line">    &lt;T&gt; <span class="function">Cursor&lt;T&gt; <span class="title">selectCursor</span><span class="params">(String var1)</span></span>;</span><br><span class="line"></span><br><span class="line">    &lt;T&gt; <span class="function">Cursor&lt;T&gt; <span class="title">selectCursor</span><span class="params">(String var1, Object var2)</span></span>;</span><br><span class="line"></span><br><span class="line">    &lt;T&gt; <span class="function">Cursor&lt;T&gt; <span class="title">selectCursor</span><span class="params">(String var1, Object var2, RowBounds var3)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">select</span><span class="params">(String var1, Object var2, ResultHandler var3)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">select</span><span class="params">(String var1, ResultHandler var2)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">select</span><span class="params">(String var1, Object var2, RowBounds var3, ResultHandler var4)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">insert</span><span class="params">(String var1)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">insert</span><span class="params">(String var1, Object var2)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">update</span><span class="params">(String var1)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">update</span><span class="params">(String var1, Object var2)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">delete</span><span class="params">(String var1)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">delete</span><span class="params">(String var1, Object var2)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">commit</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">commit</span><span class="params">(<span class="keyword">boolean</span> var1)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rollback</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rollback</span><span class="params">(<span class="keyword">boolean</span> var1)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">List&lt;BatchResult&gt; <span class="title">flushStatements</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">clearCache</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">Configuration <span class="title">getConfiguration</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    &lt;T&gt; <span class="function">T <span class="title">getMapper</span><span class="params">(Class&lt;T&gt; var1)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">Connection <span class="title">getConnection</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;æ¦‚å¿µ&quot;&gt;&lt;a href=&quot;#æ¦‚å¿µ&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚å¿µ&quot;&gt;&lt;/a&gt;æ¦‚å¿µ&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;è£…é¥°å™¨æ¨¡å¼åˆç§°åŒ…è£…æ¨¡å¼ï¼Œæ˜¯ä¸€ç§ç»“æ„å‹æ¨¡å¼ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§è®¾è®¡æ¨¡å¼æ˜¯æŒ‡èƒ½å¤Ÿåœ¨ä¸€ä¸ªç±»çš„åŸºç¡€ä¸Šå¢åŠ ä¸€ä¸ªè£…é¥°ç±»ï¼ˆä¹Ÿå¯</summary>
      
    
    
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="http://example.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
  </entry>
  
  <entry>
    <title>åŸºç¡€åŠŸèƒ½åŒ…-reflectionåŒ…</title>
    <link href="http://example.com/2021/05/17/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD%E5%8C%85-reflection%E5%8C%85/"/>
    <id>http://example.com/2021/05/17/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD%E5%8C%85-reflection%E5%8C%85/</id>
    <published>2021-05-17T03:23:10.000Z</published>
    <updated>2021-05-17T03:23:10.667Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title>åŸºç¡€åŠŸèƒ½åŒ…-exceptionsåŒ…</title>
    <link href="http://example.com/2021/05/16/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD%E5%8C%85-exceptions%E5%8C%85/"/>
    <id>http://example.com/2021/05/16/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD%E5%8C%85-exceptions%E5%8C%85/</id>
    <published>2021-05-16T15:32:40.000Z</published>
    <updated>2021-05-16T16:14:37.293Z</updated>
    
    <content type="html"><![CDATA[<h4 id="javaå¼‚å¸¸ä½“ç³»"><a href="#javaå¼‚å¸¸ä½“ç³»" class="headerlink" title="javaå¼‚å¸¸ä½“ç³»"></a>javaå¼‚å¸¸ä½“ç³»</h4><p><img src="/2021/05/16/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD%E5%8C%85-exceptions%E5%8C%85/exception1.jpeg" alt="å¼‚å¸¸ä½“ç³»"></p><!--ThrowableåŠå…¶å­ç±»ç±»å›¾--><blockquote><p>å›¾ä¸­æ‰€æœ‰å¼‚å¸¸ï¼ŒErroråŠå…¶å­ç±»ä»£è¡¨JVMå‡ºç°å¼‚å¸¸ï¼Œä¸”æ— æ³•é€šè¿‡è½¯ä»¶ä¿®å¤ï¼›</p><p>RuntimeException åŠå…¶å­ç±»æ˜¯ç¨‹åºè®¾è®¡çš„é”™è¯¯ï¼Œå¯ä»¥åœ¨ç¼–å†™ç¨‹åºæ—¶é¿å…ã€‚</p><p>ä»¥ä¸Šè¿™ä¸¤å¤§ç±»å¼‚å¸¸ç§°ä¸ºå…æ£€å¼‚å¸¸ï¼Œå³ä¸éœ€è¦å¯¹è¿™ä¸¤ç±»å¼‚å¸¸è¿›è¡Œå¼ºåˆ¶æ£€æŸ¥ã€‚</p><p>è€Œé™¤ä¸Šè¿°ä¸¤ç±»å¼‚å¸¸å¤–çš„å…¶ä»–å¼‚å¸¸ï¼Œå®ƒä»¬çš„å‘ç”Ÿä¸å¤–éƒ¨ç¯å¢ƒæœ‰å…³ï¼Œç§°ä¸º<strong>å¿…æ£€å¼‚å¸¸</strong>ã€‚<strong>åœ¨ç¼–å†™ç¨‹åºæ—¶å¿…é¡»ç”¨ tryã€catch è¯­å¥å°†å…¶åŒ…å›´èµ·æ¥ã€‚</strong></p></blockquote><h4 id="å¼‚å¸¸é“¾"><a href="#å¼‚å¸¸é“¾" class="headerlink" title="å¼‚å¸¸é“¾"></a>å¼‚å¸¸é“¾</h4><p><img src="/2021/05/16/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD%E5%8C%85-exceptions%E5%8C%85/exception2.jpeg" alt="å¼‚å¸¸é“¾"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Throwable</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"> <span class="keyword">private</span> String detailMessage; <span class="comment">// ç”¨æ¥å­˜å‚¨å¼‚å¸¸çš„è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line"> <span class="keyword">private</span> Throwable cause = <span class="keyword">this</span>;   <span class="comment">// ç”¨æ¥å­˜å‚¨å¼•å‘å¼‚å¸¸çš„åŸå› </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Throwableå¯¹è±¡ï¼Œå…¶ä¸»è¦çš„æˆå‘˜å˜é‡æœ‰ detailMessageå’Œcauseã€‚</p></blockquote><h4 id="åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"><a href="#åºåˆ—åŒ–ä¸ååºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"></a>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</h4><blockquote><p>åºåˆ—åŒ–æ˜¯æŠŠå¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—çš„è¿‡ç¨‹ï¼›ååºåˆ—åŒ–æ˜¯æŠŠå­—èŠ‚åºåˆ—æ¢å¤ä¸ºå¯¹è±¡çš„è¿‡ç¨‹ã€‚</p><p>å¯¹è±¡çš„åºåˆ—åŒ–ä¸»è¦æœ‰ä¸¤ä¸ªç›®çš„ï¼šä¸€æ˜¯å°†å¯¹è±¡è½¬åŒ–æˆå­—èŠ‚åä¿å­˜åœ¨å­˜å‚¨ä»‹è´¨ä¸­ï¼Œå³ä¸ºäº†æŒä¹…åŒ–å¯¹è±¡ï¼›äºŒæ˜¯å°†å¯¹è±¡è½¬åŒ–æˆå­—èŠ‚ååœ¨ç½‘ç»œä¸Šä¼ è¾“ï¼Œå³ä¸ºäº†ä¼ è¾“å¯¹è±¡ã€‚</p><p>è€Œä¸ä¹‹å¯¹åº”ï¼Œå°†å­—èŠ‚è¿˜åŸä¸ºå¯¹è±¡çš„è¿‡ç¨‹å°±æ˜¯ååºåˆ—åŒ–ã€‚</p></blockquote><p>åºåˆ—åŒ–å¯¹è±¡çš„ç›®çš„æœ‰ä¸¤ä¸ªï¼š</p><pre><code>1.  å¯¹è±¡æ•°æ®æŒä¹…åŒ– 2.  åœ¨ç½‘ç»œä¸­ä¼ è¾“</code></pre><p>åœ¨ Javaä¸­ï¼Œè¦è¡¨æ˜ä¸€ä¸ªç±»çš„å¯¹è±¡æ˜¯å¯åºåˆ—åŒ–çš„ï¼Œåˆ™å¿…é¡»ç»§æ‰¿Serializableæ¥å£æˆ–å…¶å­æ¥å£ Externalizableæ¥å£ã€‚</p><h5 id="serialVersionUID"><a href="#serialVersionUID" class="headerlink" title="serialVersionUID"></a>serialVersionUID</h5><p>serialVersionUIDå­—æ®µå«ä½œ<strong>åºåˆ—åŒ–ç‰ˆæœ¬æ§åˆ¶å­—æ®µ</strong>ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šåœ¨å®ç°äº† Serializable æ¥å£çš„ç±»ä¸­è§åˆ°å®ƒã€‚</p><blockquote><p>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œè¦é¢ä¸´ç‰ˆæœ¬é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå°†ä¸€ä¸ªUserç±»çš„å¯¹è±¡ user1æŒä¹…åŒ–åˆ°äº†ç¡¬ç›˜ä¸­ï¼Œç„¶åå¢åˆ äº† Userç±»çš„å±æ€§ï¼Œé‚£ä¹ˆæ­¤æ—¶è¿˜èƒ½å°†æŒä¹…åŒ–åœ¨ç¡¬ç›˜ä¸­çš„ user1å¯¹è±¡çš„åºåˆ—è¿˜åŸæˆä¸€ä¸ªæ–°çš„ Userç±»çš„å¯¹è±¡å—ï¼Ÿ</p><p>è¯¥é—®é¢˜çš„å›ç­”éœ€è¦æ¶‰åŠ Serializableæ¥å£çš„ serialVersionUIDå­—æ®µã€‚</p><p>åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå¯¹è±¡å­—èŠ‚åºåˆ—ä¸­çš„ serialVersionUIDä¸å½“å‰ç±»çš„è¯¥å€¼ä¸åŒï¼Œåˆ™ååºåˆ—åŒ–å¤±è´¥ï¼Œå¦åˆ™æˆåŠŸã€‚</p></blockquote><p>åœ¨ä½¿ç”¨æ—¶ï¼Œä¸€èˆ¬éƒ½ä¼šä¸ºå®ç°Serializableæ¥å£çš„ç±»<strong>æ˜¾å¼å£°æ˜ä¸€ä¸ªserialVersionUID</strong>ã€‚è¿™æ ·ä¾¿å¯ä»¥ï¼š</p><blockquote><p> åœ¨å¸Œæœ›ç±»çš„ç‰ˆæœ¬é—´å®ç°åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„å…¼å®¹æ—¶ï¼Œä¿æŒserialVersionUIDå€¼ä¸å˜ã€‚</p><p> åœ¨å¸Œæœ›ç±»çš„ç‰ˆæœ¬é—´åºåˆ—åŒ–å’Œååºåˆ—åŒ–ä¸å…¼å®¹æ—¶ï¼Œç¡®ä¿serialVersionUIDå€¼å‘ç”Ÿå˜åŒ–ã€‚</p></blockquote><p>mybatiså¼‚å¸¸ä½“ç³»</p><p><img src="/2021/05/16/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD%E5%8C%85-exceptions%E5%8C%85/exception3.jpeg" alt="mybatiså¼‚å¸¸ä½“ç³»"></p><blockquote><p>IbatisExceptionç±»ä»…ä»…ä½œä¸ºPersistenceExceptionç±»çš„çˆ¶ç±»å­˜åœ¨ï¼Œæ‰€ä»¥IbatisExceptionç±»æ˜¯è¢«æ¶ç©ºçš„ï¼Œå¯ä»¥åˆ é™¤IbatisExceptionç±»åï¼Œè®©PersistenceExceptionç±»ç›´æ¥ç»§æ‰¿RuntimeExceptionç±»ã€‚</p></blockquote><h4 id="ExceptionFactory"><a href="#ExceptionFactory" class="headerlink" title="ExceptionFactory"></a>ExceptionFactory</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExceptionFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä¸å…è®¸å®ä¾‹åŒ–è¯¥ç±»</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">ExceptionFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Prevent Instantiation</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// é™æ€æ–¹æ³•ï¼Œç›´æ¥è°ƒç”¨</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * ç”Ÿæˆä¸€ä¸ªRuntimeExceptionå¼‚å¸¸</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> message å¼‚å¸¸ä¿¡æ¯</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> e å¼‚å¸¸</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> æ–°çš„RuntimeExceptionå¼‚å¸¸</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> RuntimeException <span class="title">wrapException</span><span class="params">(String message, Exception e)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> PersistenceException(ErrorContext.instance().message(message).cause(e).toString(), e);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;javaå¼‚å¸¸ä½“ç³»&quot;&gt;&lt;a href=&quot;#javaå¼‚å¸¸ä½“ç³»&quot; class=&quot;headerlink&quot; title=&quot;javaå¼‚å¸¸ä½“ç³»&quot;&gt;&lt;/a&gt;javaå¼‚å¸¸ä½“ç³»&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;/2021/05/16/%E5%9F%BA%E7%A1%80%E5%8A</summary>
      
    
    
    
    <category term="mybatis" scheme="http://example.com/categories/mybatis/"/>
    
    
  </entry>
  
  <entry>
    <title>å…³é”®å­—</title>
    <link href="http://example.com/2021/05/16/%E5%85%B3%E9%94%AE%E5%AD%97/"/>
    <id>http://example.com/2021/05/16/%E5%85%B3%E9%94%AE%E5%AD%97/</id>
    <published>2021-05-16T10:26:03.000Z</published>
    <updated>2021-05-16T12:04:24.691Z</updated>
    
    <content type="html"><![CDATA[<p>javaä¸­åŒ…å«å¾ˆå¤šå…³é”®å­—ï¼Œæ¯”å¦‚staticã€finalã€synchronizedã€transientç­‰ç­‰ï¼Œæœ‰äº›åœ¨æ—¥å¸¸å¼€å‘ä¸­æ¯”è¾ƒå¸¸ç”¨ï¼Œæœ‰äº›ä¸å¸¸ç”¨ï¼Œç”šè‡³â€åªçŸ¥å…¶åï¼Œä¸è§å…¶èº«â€ï¼Œå¸Œæœ›åœ¨è¿™æ¬¡æ€»ç»“å­¦ä¹ çš„è¿‡ç¨‹ä¸­èƒ½å¯¹javaå…³é”®å­—æœ‰æ›´æ·±å…¥çš„ç†è§£ã€‚</p><h4 id="final"><a href="#final" class="headerlink" title="final"></a>final</h4><p><a href="https://zhuanlan.zhihu.com/p/33083924">https://zhuanlan.zhihu.com/p/33083924</a></p><p>å¦‚æœæœ‰äººç°åœ¨é—®æˆ‘ï¼Œfinalå…³é”®å­—çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿæˆ‘çš„å›ç­”æ˜¯â€è¢«finalä¿®é¥°çš„å˜é‡æ˜¯å¸¸é‡ï¼Œä¸èƒ½ä¿®æ”¹â€ã€‚è¿™ä¸ªå›ç­”å°±å¾ˆlowï¼Œæ¥çœ‹çœ‹æ­£ç¡®ä½¿ç”¨finalçš„å§¿åŠ¿æœ‰å“ªäº›?</p><p><strong>finalå¯ä»¥ç”¨æ¥ä¿®é¥°ç±»ã€æ–¹æ³•å’Œå˜é‡ã€‚</strong></p><h5 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h5><p>ç”¨finalä¿®é¥°æ™®é€šå˜é‡é€šå¸¸åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œä¿®é¥°æ™®é€šåŸºæœ¬ç±»å˜é‡å’Œä¿®é¥°å¼•ç”¨ç±»å‹å˜é‡ï¼Œä¹Ÿå°±æ˜¯å¯¹è±¡ç±»å‹å˜é‡ã€‚</p><h6 id="æ™®é€šå˜é‡"><a href="#æ™®é€šå˜é‡" class="headerlink" title="æ™®é€šå˜é‡"></a>æ™®é€šå˜é‡</h6><p>ä¿®é¥°æ™®é€šåŸºæœ¬ç±»å‹å˜é‡æœ€èƒ½æ¸…æ¥šç›´ç™½çš„è¡¨ç°å‡ºfinalçš„ä½œç”¨ï¼Œå®ƒèƒ½ä½¿å˜é‡çš„å€¼æ— æ³•æ”¹å˜ï¼Œå› ä¸ºå˜é‡ä¸èƒ½å†æ¬¡è¢«èµ‹å€¼ã€‚</p><p><img src="/2021/05/16/%E5%85%B3%E9%94%AE%E5%AD%97/final1.png" alt="final1"></p><p>è¿è¡Œæ­¤ç¨‹åºï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// java: æ— æ³•ä¸ºæœ€ç»ˆå˜é‡ageåˆ†é…å€¼</span></span><br></pre></td></tr></table></figure><h6 id="å¼•ç”¨ç±»å‹"><a href="#å¼•ç”¨ç±»å‹" class="headerlink" title="å¼•ç”¨ç±»å‹"></a>å¼•ç”¨ç±»å‹</h6><p>ä½¿ç”¨finalä¿®é¥°å¼•ç”¨ç±»å‹å˜é‡æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¿è¯å˜é‡ä¸èƒ½è¢«å†æ¬¡èµ‹å€¼ï¼Œ ä½†æˆ‘ä»¬æ— æ³•ä¿è¯å¯¹è±¡å€¼çš„æ”¹å˜ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> StringBuilder sb = <span class="keyword">new</span> StringBuilder(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">sb.append(<span class="string">&quot;world&quot;</span>);</span><br><span class="line">System.out.println(sb); <span class="comment">//  ç»“æœï¼šhelloworld</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> StringBuilder sb = <span class="keyword">new</span> StringBuilder(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">StringBuilder sb2 = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">sb = sb2;  <span class="comment">//  ç¼–è¯‘é”™è¯¯ï¼šæ— æ³•ä¸ºæœ€ç»ˆå˜é‡sbåˆ†é…å€¼</span></span><br></pre></td></tr></table></figure><blockquote><p>å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œ è™½ç„¶æˆ‘ä»¬ç”¨finalä¿®é¥°å˜é‡ï¼Œä½†ä»æ—§æ— æ³•é˜»æ­¢å˜é‡å†…åœ¨å€¼çš„æ”¹å˜ã€‚ ä½¿ç”¨finalèƒ½ä¿è¯å˜é‡ä¸èƒ½æ”¹å˜å¼•ç”¨çš„ç›®æ ‡ï¼Œå´ä¸èƒ½ä¿è¯å˜é‡æ‰€å¼•ç”¨çš„ç›®æ ‡æœ¬èº«çš„å˜åŒ–ã€‚å› ä¸ºå¯¹äºåŸºæœ¬ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå˜é‡çœ‹ä½œæ˜¯å˜é‡å€¼çš„æœ¬èº«ï¼›è€Œå¯¹äºå¼•ç”¨ç±»å‹å˜é‡ï¼Œå˜é‡å’Œå˜é‡çš„å€¼éœ€è¦åŒºåˆ†çœ‹å¾…ï¼Œå®ƒä»¬åªæ˜¯ä»¥æŸç§æ–¹å¼è¢«å…³è”èµ·æ¥äº†è€Œå·²ï¼Œäº‹å®ä¸Šå®ƒä»¬æ˜¯ä¸åŒçš„ä¸œè¥¿ï¼Œæ‰€ä»¥finalæ— æ³•åŒæ—¶ä½œç”¨äºä¸¤è€…ä¸Šã€‚</p></blockquote><h5 id="å¸¸é‡"><a href="#å¸¸é‡" class="headerlink" title="å¸¸é‡"></a>å¸¸é‡</h5><p>å¸¸é‡æ˜¯å…¨å±€çš„ã€ä¸å¯å˜çš„ï¼Œå› æ­¤æˆ‘ä»¬åŒæ—¶ä½¿ç”¨staticå’Œfinalæ¥ä¿®é¥°å˜é‡ï¼Œå°±èƒ½è¾¾åˆ°å®šä¹‰å¸¸é‡çš„æ•ˆæœã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> CONST_ONE = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> CONST_TWO = <span class="number">2</span>;</span><br></pre></td></tr></table></figure><h5 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h5><p>finalå¯ä»¥ä¿è¯å®ä¾‹å˜é‡å¿…é¡»è¢«åˆå§‹åŒ–ï¼Œè¿™ç‚¹ç‰¹æ€§èƒ½å‡å°‘ä»£ç å‡ºé”™å‡ ç‡ï¼Œå¦‚ä»¤æ‰€æœ‰Javaç¨‹åºå‘˜å¤´ç–¼çš„NullPointerExceptionã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Person person = <span class="keyword">new</span> Person();</span><br><span class="line">        System.out.println(person.toString().toLowerCase());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä»¥ä¸Šä»£ç å› ä¸ºæ²¡ç»™nameèµ‹å€¼ï¼Œä»£ç åœ¨è¿è¡Œèµ·å°†æŠ¥NPEå¼‚å¸¸ã€‚å‡å¦‚æˆ‘ä»¬ä½¿ç”¨finalä¿®é¥°nameå˜é‡ï¼Œä»£ç å°†æ— æ³•é€šè¿‡ç¼–è¯‘ï¼Œå› ä¸ºJavaè¯­æ³•è§„å®šï¼Œfinalå˜é‡åœ¨ä½¿ç”¨å‰å¿…é¡»è¢«åˆå§‹åŒ–ï¼Œ<strong>å› æ­¤æˆ‘ä»¬å¿…é¡»åœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–nameå˜é‡ï¼Œ</strong>è¿™æ ·èƒ½ç™¾åˆ†ç™¾ä¿è¯æˆ‘ä»¬ä½¿ç”¨çš„nameå˜é‡ä¸ä¼šæ˜¯nullã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Person person = <span class="keyword">new</span> Person(<span class="string">&quot;dly&quot;</span>);</span><br><span class="line">        System.out.println(person.toString().toLowerCase());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="ä¿®é¥°æ–¹æ³•"><a href="#ä¿®é¥°æ–¹æ³•" class="headerlink" title="ä¿®é¥°æ–¹æ³•"></a>ä¿®é¥°æ–¹æ³•</h5><p>ç”¨finalä¿®é¥°æ–¹æ³•ï¼Œå‡å¦‚æ–¹æ³•æ‰€å±çš„ç±»è¢«ç»§æ‰¿ï¼Œæ–¹æ³•å°†ä¸èƒ½åœ¨å­ç±»ä¸­è¢«é‡å†™ã€‚</p><blockquote><p>é€šå¸¸ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›æ–¹æ³•åœ¨è¢«ç»§æ‰¿æ—¶é‡å†™ï¼Œå¯ä»¥ç”¨privateä¿®é¥°ï¼Œå› ä¸ºè¿™æ ·æ–¹æ³•çš„å¯è§æ€§è¢«é™åˆ¶äºæ–¹æ³•æ‰€åœ¨çš„ç±»ä¸­ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å…¬å¼€æ–¹æ³•ï¼Œå´åˆä¸æƒ³æ–¹æ³•è¢«é‡å†™ï¼Œæ­¤æ—¶ç”¨finalä¿®é¥°æ–¹æ³•å°±æœ‰ç”¨æ­¦ä¹‹åœ°äº†ã€‚</p></blockquote><p>ï¼ˆç„¶è€Œï¼Œè¿™æ—¶åˆå¼•å‡ºäº†å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼Œå‡å¦‚æˆ‘ä»¬ä½¿ç”¨finalä¿®é¥°privateæ–¹æ³•ï¼Œæ˜¯å¦æœ‰å®é™…æ„ä¹‰ã€‚ äº‹å®ä¸Šï¼Œåœ¨ç°ä»£çš„jdkä¸­ï¼Œè¿™ä¹ˆåšæ˜¯æ²¡æœ‰ä»»ä½•æ„ä¹‰çš„ï¼Œå› ä¸ºprivateæ— æ³•è¢«ç»§æ‰¿ï¼Œè‡ªç„¶ä¹Ÿä¸å­˜åœ¨ç»§æ‰¿æ—¶è¢«ä¿®æ”¹çš„é—®é¢˜ã€‚ ä½†æ˜¯åœ¨æ—©æœŸçš„Javaç‰ˆæœ¬ä¸­ï¼Œfinalä¿®é¥°privateæ–¹æ³•çš„ä½œç”¨æ˜¯å‘ŠçŸ¥ç¼–è¯‘å™¨ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨ç¼–è¯‘æ—¶éœ€è¦å†…è”å¤„ç†ã€‚è¿™ä¸ªç‰¹æ€§åœ¨ç°ä»£jdkä¸­å·²ç»è¢«æŠ›å¼ƒã€‚ï¼‰</p><h5 id="ä¿®é¥°ç±»"><a href="#ä¿®é¥°ç±»" class="headerlink" title="ä¿®é¥°ç±»"></a>ä¿®é¥°ç±»</h5><p>å½“ç”¨finalä¿®é¥°ç±»æ—¶ï¼Œ è¡¨ç¤ºæ­¤ç±»æ˜¯å¯†å°çš„ï¼Œ æ— æ³•è¢«ç»§æ‰¿ã€‚ä»Javaæºç ä¸­å¯çŸ¥ï¼Œæˆ‘ä»¬æœ€å¸¸ç”¨çš„Stringç±»ä¾¿æ˜¯ä¸€ä¸ªfinalç±»ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;javaä¸­åŒ…å«å¾ˆå¤šå…³é”®å­—ï¼Œæ¯”å¦‚staticã€finalã€synchronizedã€transientç­‰ç­‰ï¼Œæœ‰äº›åœ¨æ—¥å¸¸å¼€å‘ä¸­æ¯”è¾ƒå¸¸ç”¨ï¼Œæœ‰äº›ä¸å¸¸ç”¨ï¼Œç”šè‡³â€åªçŸ¥å…¶åï¼Œä¸è§å…¶èº«â€ï¼Œå¸Œæœ›åœ¨è¿™æ¬¡æ€»ç»“å­¦ä¹ çš„è¿‡ç¨‹ä¸­èƒ½å¯¹javaå…³é”®å­—æœ‰æ›´æ·±å…¥çš„ç†è§£ã€‚&lt;/p&gt;
&lt;h4 id=&quot;final&quot;&gt;&lt;</summary>
      
    
    
    
    <category term="javaåŸºç¡€" scheme="http://example.com/categories/java%E5%9F%BA%E7%A1%80/"/>
    
    
  </entry>
  
  <entry>
    <title>mybatisæ¦‚è¿°</title>
    <link href="http://example.com/2021/05/14/mybatis%E6%BA%90%E7%A0%811/"/>
    <id>http://example.com/2021/05/14/mybatis%E6%BA%90%E7%A0%811/</id>
    <published>2021-05-14T03:02:20.000Z</published>
    <updated>2021-05-20T11:14:26.393Z</updated>
    
    <content type="html"><![CDATA[<h4 id="mybatiså­¦ä¹ æµç¨‹"><a href="#mybatiså­¦ä¹ æµç¨‹" class="headerlink" title="mybatiså­¦ä¹ æµç¨‹"></a>mybatiså­¦ä¹ æµç¨‹</h4><h5 id="ç¬¬ä¸€ç›®æ ‡ï¼šSqlæ‰§è¡Œæµç¨‹"><a href="#ç¬¬ä¸€ç›®æ ‡ï¼šSqlæ‰§è¡Œæµç¨‹" class="headerlink" title="ç¬¬ä¸€ç›®æ ‡ï¼šSqlæ‰§è¡Œæµç¨‹"></a>ç¬¬ä¸€ç›®æ ‡ï¼šSqlæ‰§è¡Œæµç¨‹</h5><blockquote><p>MyBatisæºç å­¦ä¹ çš„ç¬¬ä¸€ä¸ªç›®æ ‡å°±æ˜¯è¦æå®šå››ä¸ªç»„ä»¶æ‰€ç»„æˆçš„Sqlæ‰§è¡Œæµç¨‹ã€‚è¿™ä¸ªå››ä¸ªç»„ä»¶åˆ†åˆ«æ˜¯ï¼Œæ‰§è¡Œå™¨(Execute)ã€Sqlå¤„ç†å™¨(StatementHandler)ã€å‚æ•°å¤„ç†å™¨(ParameterHandler)ã€ç»“æœé›†å¤„ç†å™¨(ResultSetHandler)ã€‚è¿™ä¸ªç›®æ ‡åˆå¯åˆ†è§£æˆ4ä¸ªå°ç›®æ ‡</p><ol><li>ç†è§£å››ä¸ªç»„ä»¶æ‰§è¡Œä¸Šçš„é¡ºåº</li><li>æ¯ä¸ªç»„ä»¶çš„ä½œç”¨åŠæ„ä¹‰</li><li>æŒæ¡Execute çš„ä¸‰ä¸ªå®ç°é€»è¾‘</li><li>æŒæ¡StatementHandlerçš„ä¸‰ä¸ªå®ç°é€»è¾‘</li></ol><p>è¿™ä¸ªç›®æ ‡ä¸æ˜¯æœ€éš¾çš„ï¼Œä½†æ˜¯æœ€è¦çš„ã€‚å¦‚æœæœ‰ä¸€å¤©ä½ æŠŠå­¦çš„MyBatisæºç å¿˜çš„å·®ä¸å¤šäº†ï¼Œä¹Ÿå¸Œæœ›ä½ è¿™ä¸ªæµç¨‹ä¸è¦å¿˜ï¼Œè¿™æ˜¯MySqlæºç çš„ä¸»å¹²å’Œè‚ªè„‰ç»œã€‚é¡ºç€å®ƒå°±å¯ä»¥æŠŠMyBatisçŸ¥è¯†å†æ‹¾å›æ¥ã€‚</p><p>è¯´æ˜ï¼šå…³äºå‚æ•°å¤„ç†ã€ç»“æœé›†å¤„ç†å…¶ä¸»è¦é€»è¾‘ç»†èŠ‚åœ¨äºæ˜ å°„å¤„ç†ï¼Œå¯ä»¥æ”¾åˆ°æ˜ å°„ç¯‡ç« å­¦ä¹ ã€‚</p></blockquote><h5 id="ç¬¬äºŒç›®æ ‡ï¼šæ˜ å°„é…ç½®"><a href="#ç¬¬äºŒç›®æ ‡ï¼šæ˜ å°„é…ç½®" class="headerlink" title="ç¬¬äºŒç›®æ ‡ï¼šæ˜ å°„é…ç½®"></a><strong>ç¬¬äºŒç›®æ ‡ï¼šæ˜ å°„é…ç½®</strong></h5><p>ç¬¬äºŒä¸ªè¦æå®šçš„ç›®æ ‡ï¼Œå°±æ˜¯SQLæ‰§è¡Œæµç¨‹å½“ä¸­ï¼Œæ‰€éœ€è¦çš„ä¸‰å¤§æ˜ å°„ï¼šåˆ†åˆ«æ˜¯åŠ¨æ€SQLæ˜ å°„ã€å‚æ•°æ˜ å°„ã€ä»¥åŠç»“æœé›†æ˜ å°„ã€‚ä¸ä»…è¦ææ¸…æ¥šæ˜ å°„é…ç½®çš„åŠ è½½ä¸è§£æï¼Œæ›´é‡è¦çš„å¼„æ¸…æ¥šæ˜ å°„é€»è¾‘ã€‚</p><ul><li><strong>åŠ è½½è§£æ</strong>ï¼šæŒ‡ç”¨æˆ·é…ç½®çš„XMLè§£ææˆJAVAé…ç½®å¯¹è±¡ã€‚æ¯”å¦‚<code>&lt;Select&gt;....&lt;/Select&gt;</code>å—,æœ€ç»ˆè¦è§£ææˆSqlSourceã€‚æˆ–<code>&lt;resultMap&gt;...&lt;/resultMap&gt;</code> è¦è§£ææˆResultMapå¯¹è±¡ã€‚</li><li><strong>æ˜ å°„é€»è¾‘</strong>ï¼šæ¯”å¦‚SqlSourceå¦‚ä½•åŸºäºå‚æ•°ç”Ÿæˆå¯æ‰§è¡ŒSQLï¼ŒResultMapå¦‚ä½•å°†ç»“æœé›†ï¼Œè§£ææˆJAVAå¯¹è±¡ç­‰ã€‚</li></ul><p>è¿™é‡Œé¢æ¶‰åŠå†…å®¹éå¸¸å¤šï¼ŒåŒæ ·å¯ä»¥åˆ’åˆ†æˆä¸€ä¸ªä¸ªå°ç›®æ ‡ï¼š</p><blockquote><table><thead><tr><th><strong>å°ç›®æ ‡</strong></th><th align="left"></th></tr></thead><tbody><tr><td>1</td><td align="left">ç†è§£Sqlæ˜ å°„å£°æ˜(MappedStatement)çš„ä½œç”¨ï¼Œä»¥åŠå®ƒä¸ä¸‰å¤§æ˜ å°„çš„å…³ç³»ã€‚</td></tr><tr><td>2</td><td align="left">æŒæ¡åŠ¨æ€SQL(sqlSource)è§£æè¿‡ç¨‹ï¼ŒåŒ…æ‹¬å…¶è„šæœ¬è¡¨è¾¾ç¤ºçš„æ‰§è¡Œé€»è¾‘</td></tr><tr><td>3</td><td align="left">æŒæ¡MyBatisæ‰€å°è£…çš„æ˜ å°„å·¥å…·åŒ…çš„ä½¿ç”¨</td></tr><tr><td>4</td><td align="left">æŒæ¡å‚æ•°è½¬æ¢è¿‡ç¨‹ï¼Œä»¥åŠæ˜ å°„çš„å°è£…è¿‡ç¨‹</td></tr><tr><td>5</td><td align="left">æŒæ¡ç»“æœé›†æ˜ å°„æ ¸å¿ƒé€»è¾‘ï¼ŒåŒ…æ‹¬å…³è”æ˜ å°„ï¼Œ1å¯¹1ã€1å¯¹å¤šçš„å¤„ç†ã€‚è¿˜æœ‰æ›´å¤æ‚çš„å¾ªç¯ä¾èµ–å¤„ç†</td></tr><tr><td>6</td><td align="left">æŒæ¡å…¨éƒ¨é…ç½®(Confgiuration) çš„æ ¸å¿ƒå®šä½,ä»¥åŠå®ƒçš„åŠ è½½è§£æè¿‡ç¨‹</td></tr></tbody></table><p>ç»“æœé›†æ˜ å°„æ˜¯æ•´ä¸ªMyBatisæºç å½“ä¸­çš„æœ€éš¾çš„ç‚¹ï¼Œå…¶å…³è”æ˜ å°„ä¼šæ¶‰åŠå­æŸ¥è¯¢ã€ä¸€çº§ç¼“å­˜å¼•ç”¨ã€å¾ªç¯ä¾èµ–ã€å»¶è¿ŸåŠ è½½ã€æ‡’åŠ è½½ã€è‡ªåŠ¨æ˜ å°„ç­‰çŸ¥è¯†ç‚¹ã€‚ä¸ªä¸ªéƒ½ä¸æ˜¯å–„èŒ¬ï¼Œæ”»å…‹ä¸æ˜“ã€‚</p></blockquote><h5 id="ç¬¬ä¸‰ç›®æ ‡ï¼šæ‰©å±•æ”¯æ’‘"><a href="#ç¬¬ä¸‰ç›®æ ‡ï¼šæ‰©å±•æ”¯æ’‘" class="headerlink" title="ç¬¬ä¸‰ç›®æ ‡ï¼šæ‰©å±•æ”¯æ’‘"></a><strong>ç¬¬ä¸‰ç›®æ ‡ï¼šæ‰©å±•æ”¯æ’‘</strong></h5><p>å‰é¢ä¸¤ä¸ªç›®æ ‡å¦‚æœæå®šäº†ï¼Œæ­å–œä½ ï¼ŒMyBatiså®è´¨ä¸Šä½ å·²ç»æ‹¿ä¸‹äº†ï¼Œæ¥ä¸‹æ¥çš„å­¦ä¹ å°±ä¼šæœ‰ä¸€ç§æ°´é“æ¸ æˆçš„è½»æ¾ã€‚</p><p>æ‰€è°“æ‰©å±•æŒ‡å¯¹ä¸»æµç¨‹çš„å»¶ä¼¸ã€‚å¦‚ï¼šé€šè¿‡æ‰§è¡Œå™¨å¯ä»¥å®Œæˆæ‰€æœ‰åŠŸèƒ½ï¼Œä½†ä½¿ç”¨å¤ªç¹çï¼Œä¼šè¯(SqlSession)æ­£æ˜¯ä¸ºç®€åŒ–å®ƒçš„ä½¿ç”¨ã€‚Mapperæ¥å£çš„è®¾å®šä¹Ÿæ˜¯ä¸€æ ·ï¼Œæ˜¯ä¸ºè¿›ä¸€æ­¥ç®€åŒ–ä½¿ç”¨ä¼šè¯ã€‚</p><p>é™¤äº†é’ˆå¯¹æ˜“ç”¨æ€§æ‰©å±•ï¼Œè¿˜æœ‰æé«˜æ‰§è¡Œæ€§èƒ½çš„æ‰©å±•ï¼Œæ¯”å¦‚ï¼šç¼“å­˜ã€æ‡’åŠ è½½ç­‰ã€‚æœ€åçš„æ’ä»¶æœºåˆ¶åˆ™æ˜¯æš´éœ²ç»™ç”¨æˆ·è‡ªå®šä¹‰çš„æ‰©å±•ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ç»§ç»­åˆ†è§£å­¦ä¹ ç›®æ ‡ï¼š</p><blockquote><table><thead><tr><th><strong>å°ç›®æ ‡</strong></th><th></th></tr></thead><tbody><tr><td>1</td><td>æŒæ¡ä¸€äºŒçº§ç¼“å­˜çš„ç»“æ„ï¼ŒåŠæ‰§è¡Œé€»è¾‘ã€‚</td></tr><tr><td>2</td><td>ç†è§£ä¼šè¯çš„æ„ä¹‰å’Œå…¶é‡‡ç”¨çš„è®¾è®¡æ¨¡å¼ã€‚</td></tr><tr><td>3</td><td>æŒæ¡Mapperæ¥å£åŠ¨æ€ä»£ç†æµç¨‹ã€‚</td></tr><tr><td>4</td><td>æŒæ¡æ’ä»¶æœºåˆ¶åº•å±‚åŸç†ã€‚</td></tr><tr><td>5</td><td>æŒæ¡æ‡’åŠ è½½çš„æµç¨‹ã€‚</td></tr></tbody></table><p>åœ¨å½“å‰å†…å®¹å­¦ä¹ è¿‡ç¨‹å½“ä¸­ï¼Œ ä½ ä¹Ÿä¼šæŒæ¡å¤§é‡çš„è®¾è®¡æ¨¡å¼ï¼Œå¦‚äºŒçº§ç¼“å­˜çš„è£…é¥°å™¨+è´£ä»»é“¾æ¨¡å¼ã€ä¼šè¯æ‰€é‡‡ç”¨çš„é—¨é¢æ¨¡å¼ã€ä»¥åŠMapperæ¥å£å¯¹åº”åŠ¨æ€ä»£ç†æ¨¡å¼ç­‰ã€‚</p></blockquote><h4 id="é˜…è¯»ç­–ç•¥"><a href="#é˜…è¯»ç­–ç•¥" class="headerlink" title="é˜…è¯»ç­–ç•¥"></a>é˜…è¯»ç­–ç•¥</h4><p>æ‰¾å‡ºè½¯ä»¶é¡¹ç›®çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œé‡ç‚¹å…³æ³¨ä¸æ ¸å¿ƒåŠŸèƒ½ç›¸å…³çš„ä»£ç ã€‚</p><h4 id="mybatisæ ¸å¿ƒåŠŸèƒ½"><a href="#mybatisæ ¸å¿ƒåŠŸèƒ½" class="headerlink" title="mybatisæ ¸å¿ƒåŠŸèƒ½"></a>mybatisæ ¸å¿ƒåŠŸèƒ½</h4><ul><li>å°†åŒ…å« ifç­‰æ ‡ç­¾çš„å¤æ‚æ•°æ®åº“æ“ä½œè¯­å¥è§£æä¸ºçº¯ç²¹çš„ SQLè¯­å¥ã€‚</li><li>å°†æ•°æ®åº“æ“ä½œèŠ‚ç‚¹å’Œæ˜ å°„æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•è¿›è¡Œç»‘å®šï¼Œåœ¨æŠ½è±¡æ–¹æ³•è¢«è°ƒç”¨æ—¶æ‰§è¡Œæ•°æ®åº“æ“ä½œã€‚</li><li>å°†è¾“å…¥å‚æ•°å¯¹è±¡è½¬åŒ–ä¸ºæ•°æ®åº“æ“ä½œè¯­å¥ä¸­çš„å‚æ•°ã€‚</li><li>å°†æ•°æ®åº“æ“ä½œè¯­å¥çš„è¿”å›ç»“æœè½¬åŒ–ä¸ºå¯¹è±¡ã€‚</li></ul><h4 id="mybatisåŒ…ç»“æ„"><a href="#mybatisåŒ…ç»“æ„" class="headerlink" title="mybatisåŒ…ç»“æ„"></a>mybatisåŒ…ç»“æ„</h4><p><img src="/2021/05/14/mybatis%E6%BA%90%E7%A0%811/mabatis1.jpeg" alt="åŒ…ç»“æ„"></p><h4 id="é˜…è¯»æŠ€å·§"><a href="#é˜…è¯»æŠ€å·§" class="headerlink" title="é˜…è¯»æŠ€å·§"></a>é˜…è¯»æŠ€å·§</h4><blockquote><p>æºç é˜…è¯»è¿‡ç¨‹ä¸­æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„æŠ€å·§ï¼Œé‚£å°±æ˜¯ä»æ•´ä¸ªé¡¹ç›®çš„å¤–å›´æºç å…¥æ‰‹ã€‚</p><p>å¤–å›´æºç å¾ˆå°‘ä¾èµ–æ ¸å¿ƒæºç ï¼Œç›¸å¯¹ç‹¬ç«‹ã€‚å…ˆé˜…è¯»å¤–å›´æºç ï¼Œå—åˆ°å…¶ä»–æœªé˜…è¯»éƒ¨åˆ†çš„å¹²æ‰°è¾ƒå°ã€‚</p><p>æ ¸å¿ƒæºç å¤§é‡ä¾èµ–å¤–å›´æºç ã€‚åœ¨é˜…è¯»æ ¸å¿ƒæºç æ—¶åº”ç¡®ä¿å…¶æ¶‰åŠçš„å¤–å›´æºç å‡å·²é˜…è¯»å®Œæ¯•ï¼Œè¿™æ ·å¯ä»¥é™ä½æ ¸å¿ƒæºç çš„é˜…è¯»éš¾åº¦ã€‚</p><p>äºæ˜¯æ•´ä¸ªæºç é˜…è¯»è¿‡ç¨‹ä¼šå¦‚åŒå‰¥æ´‹è‘±ä¸€èˆ¬ï¼Œç”±å¤–åŠå†…ã€é€å±‚æ·±å…¥ã€‚</p><p>MyBatis æºç ä¸­ï¼ŒåŸºç¡€åŠŸèƒ½åŒ…æ˜¯æœ€å¤–å›´çš„åŒ…ï¼Œé…ç½®è§£æåŒ…ä½äºä¸­é—´ï¼Œæ ¸å¿ƒæ“ä½œåŒ…ä½äºå†…å±‚ã€‚å› æ­¤ï¼Œæœ¬ä¹¦ä¸­ä¼šæŒ‰ç…§åŸºç¡€åŠŸèƒ½åŒ…ã€é…ç½®è§£æåŒ…ã€æ ¸å¿ƒæ“ä½œåŒ…çš„é¡ºåºï¼Œä»¥åŒ…ä¸ºå•ä½ï¼Œå¯¹åŒ…ä¸­çš„æºä»£ç é€ä¸€è¿›è¡Œé˜…è¯»ã€‚</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;mybatiså­¦ä¹ æµç¨‹&quot;&gt;&lt;a href=&quot;#mybatiså­¦ä¹ æµç¨‹&quot; class=&quot;headerlink&quot; title=&quot;mybatiså­¦ä¹ æµç¨‹&quot;&gt;&lt;/a&gt;mybatiså­¦ä¹ æµç¨‹&lt;/h4&gt;&lt;h5 id=&quot;ç¬¬ä¸€ç›®æ ‡ï¼šSqlæ‰§è¡Œæµç¨‹&quot;&gt;&lt;a href=&quot;#ç¬¬ä¸€ç›®æ ‡ï¼š</summary>
      
    
    
    
    <category term="mybatis" scheme="http://example.com/categories/mybatis/"/>
    
    
  </entry>
  
  <entry>
    <title>æ¥å£å’ŒæŠ½è±¡æ–¹æ³•</title>
    <link href="http://example.com/2021/05/11/%E6%8E%A5%E5%8F%A3%E5%92%8C%E6%8A%BD%E8%B1%A1%E6%96%B9%E6%B3%95/"/>
    <id>http://example.com/2021/05/11/%E6%8E%A5%E5%8F%A3%E5%92%8C%E6%8A%BD%E8%B1%A1%E6%96%B9%E6%B3%95/</id>
    <published>2021-05-11T07:06:57.000Z</published>
    <updated>2021-05-15T09:54:39.931Z</updated>
    
    <content type="html"><![CDATA[<p>javaç±»æ‰§è¡Œé¡ºåº</p><p><a href="https://www.cnblogs.com/timetellu/p/11619158.html">https://www.cnblogs.com/timetellu/p/11619158.html</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;javaç±»æ‰§è¡Œé¡ºåº&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/timetellu/p/11619158.html&quot;&gt;https://www.cnblogs.com/timetellu/p/11619158.html&lt;/a&gt;&lt;/p&gt;
</summary>
      
    
    
    
    <category term="javaåŸºç¡€" scheme="http://example.com/categories/java%E5%9F%BA%E7%A1%80/"/>
    
    
  </entry>
  
  <entry>
    <title>æ•°å­¦ç´ å…»</title>
    <link href="http://example.com/2021/04/22/%E6%95%B0%E5%AD%A6%E7%B4%A0%E5%85%BB/"/>
    <id>http://example.com/2021/04/22/%E6%95%B0%E5%AD%A6%E7%B4%A0%E5%85%BB/</id>
    <published>2021-04-22T02:08:44.000Z</published>
    <updated>2021-04-23T03:12:31.938Z</updated>
    
    <content type="html"><![CDATA[<ol><li>ç”Ÿæ´»å’Œæ•°å­¦å¯†ä¸å¯åˆ†</li><li>å‡¡äº‹å¤šé—®å‡ ä¸ªä¸ºä»€ä¹ˆï¼ˆä¾‹: æ¸…æ¥šæŸä¸ªç†è®ºçš„å‰å› åæœï¼‰ </li><li>ç¬›å¡å°”åæ ‡ç³»ï¼ˆä»¥æŸä¸ªç‚¹ä¸ºä¸­å¿ƒï¼Œæ¨ªå‘æ‰©å±•ã€çºµå‘å»¶ä¼¸ï¼‰</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;ol&gt;
&lt;li&gt;ç”Ÿæ´»å’Œæ•°å­¦å¯†ä¸å¯åˆ†&lt;/li&gt;
&lt;li&gt;å‡¡äº‹å¤šé—®å‡ ä¸ªä¸ºä»€ä¹ˆï¼ˆä¾‹: æ¸…æ¥šæŸä¸ªç†è®ºçš„å‰å› åæœï¼‰ &lt;/li&gt;
&lt;li&gt;ç¬›å¡å°”åæ ‡ç³»ï¼ˆä»¥æŸä¸ªç‚¹ä¸ºä¸­å¿ƒï¼Œæ¨ªå‘æ‰©å±•ã€çºµå‘å»¶ä¼¸ï¼‰&lt;/li&gt;
&lt;/ol&gt;
</summary>
      
    
    
    
    <category term="æ•°å­¦" scheme="http://example.com/categories/%E6%95%B0%E5%AD%A6/"/>
    
    
  </entry>
  
  <entry>
    <title>å¸¸ç”¨gitå‘½ä»¤</title>
    <link href="http://example.com/2021/04/21/%E5%B8%B8%E7%94%A8git%E5%91%BD%E4%BB%A4/"/>
    <id>http://example.com/2021/04/21/%E5%B8%B8%E7%94%A8git%E5%91%BD%E4%BB%A4/</id>
    <published>2021-04-21T08:57:04.000Z</published>
    <updated>2021-04-23T03:14:11.769Z</updated>
    
    <content type="html"><![CDATA[<ol><li><p>åˆ›å»ºæœ¬åœ°åˆ†æ”¯    git branch åˆ†æ”¯å</p></li><li><p>åˆ é™¤åˆ†æ”¯   </p></li><li><p>æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯   git branch -a</p></li><li><p>æ£€å‡ºè¿œç¨‹åˆ†æ”¯  git checkout -b dly  origin/dly</p><p>ä¸Šé¢çš„è¯çš„æ„æ€æ˜¯ï¼šåˆ‡æ¢åˆ°æ–°çš„åˆ†æ”¯dlyï¼Œå¹¶ä¸”è·Ÿè¸ªè¿œç¨‹ä¸­çš„åˆ†æ”¯dly</p></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;åˆ›å»ºæœ¬åœ°åˆ†æ”¯    git branch åˆ†æ”¯å&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;åˆ é™¤åˆ†æ”¯   &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯   git branch -a&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ£€å‡ºè¿œç¨‹åˆ†æ”¯  git checkout </summary>
      
    
    
    
    <category term="éšç¬”" scheme="http://example.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
  </entry>
  
  <entry>
    <title>IDEAå¿«æ·é”®</title>
    <link href="http://example.com/2021/04/21/IDEA%E5%BF%AB%E6%8D%B7%E9%94%AE/"/>
    <id>http://example.com/2021/04/21/IDEA%E5%BF%AB%E6%8D%B7%E9%94%AE/</id>
    <published>2021-04-21T08:56:03.000Z</published>
    <updated>2021-05-19T07:20:32.168Z</updated>
    
    <content type="html"><![CDATA[<p>Command + O ï¼šæŸ¥æ‰¾ç±»æ–‡ä»¶</p><p>æŸ¥çœ‹å›¾è¡¨diagram ï¼š shift+option+command+u</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Command + O ï¼šæŸ¥æ‰¾ç±»æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹å›¾è¡¨diagram ï¼š shift+option+command+u&lt;/p&gt;
</summary>
      
    
    
    
    <category term="éšç¬”" scheme="http://example.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
  </entry>
  
</feed>
